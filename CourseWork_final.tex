
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{CourseWork\_final}
    
    
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{============================================================}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ Course Work                              Robiul Islam      }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{============================================================}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd} 
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{utils} \PY{k}{import} \PY{n}{shuffle}
         \PY{k+kn}{from} \PY{n+nn}{itertools} \PY{k}{import} \PY{n}{combinations}
         \PY{k+kn}{import} \PY{n+nn}{bisect}
         \PY{k+kn}{import} \PY{n+nn}{math}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         
         \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/HSE/coursework/github/DL\PYZus{}DemographicStudies/dataset/table\PYZus{}just\PYZus{}one\PYZus{}last\PYZus{}event\PYZus{}binary\PYZus{}month\PYZus{}sequence.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{;}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} 
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
============================================================
 Course Work                              Robiul Islam      
============================================================
  gender education type locality religion         how\_often generation  \textbackslash{}
0      f        general     town      yes        sev\_a\_year         9g   
1      f   professional     town      yes        sev\_a\_year        10g   
2      f         higher     town      yes        sev\_a\_year         3g   
3      m   professional     town      yes             never         9g   
4      f   professional     town      yes  min\_once\_a\_month         3g   
5      m         higher     town      yes             never         7g   
6      m        general     town      yes             never         2g   
7      m         higher     town      yes             never         8g   
8      f        general     town      yes  min\_once\_a\_month         1g   
9      m   professional     town      yes             never         8g   

   partner  marriage  break  divorce    {\ldots}      divorce work  \textbackslash{}
0        0         1      0        0    {\ldots}                 n   
1        0         1      0        0    {\ldots}                 >   
2        0         1      0        0    {\ldots}                 >   
3        1         0      0        0    {\ldots}                 >   
4        0         1      0        0    {\ldots}                 >   
5        0         1      0        0    {\ldots}                 >   
6        0         1      0        0    {\ldots}                 >   
7        1         1      1        0    {\ldots}                 >   
8        0         1      0        0    {\ldots}                 >   
9        0         1      0        0    {\ldots}                 >   

   divorce separation from parents  divorce child  education work  \textbackslash{}
0                                >              >               <   
1                                >              >               >   
2                                >              n               >   
3                                >              >               <   
4                                >              n               =   
5                                >              n               <   
6                                >              n               =   
7                                >              >               >   
8                                >              n               <   
9                                >              n               <   

   education separation from parents  education child  \textbackslash{}
0                                  >                <   
1                                  >                >   
2                                  >                <   
3                                  <                <   
4                                  <                <   
5                                  >                <   
6                                  <                <   
7                                  >                >   
8                                  <                <   
9                                  <                <   

   work separation from parents  work child  separation from parents child  \textbackslash{}
0                             >           >                              <   
1                             <           <                              <   
2                             <           <                              <   
3                             >           <                              <   
4                             <           <                              <   
5                             >           <                              <   
6                             <           <                              <   
7                             >           <                              <   
8                             <           <                              <   
9                             <           <                              <   

     last\_ev  
0       work  
1  education  
2      child  
3         br  
4      child  
5      child  
6      child  
7        div  
8      child  
9      child  

[10 rows x 51 columns]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        
        \PY{c+c1}{\PYZsh{} Some sklearn tools for preprocessing and building a pipeline. }
        \PY{c+c1}{\PYZsh{} ColumnTransformer was introduced in 0.20 so make sure you have this version}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{OneHotEncoder}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{compose} \PY{k}{import} \PY{n}{ColumnTransformer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{Pipeline}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{,} \PY{n}{GridSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}\PY{p}{,} \PY{n}{classification\PYZus{}report}
        
        \PY{c+c1}{\PYZsh{} Our algorithms, by from the easiest to the hardest to intepret.}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k}{import} \PY{n}{DecisionTreeClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
        \PY{k+kn}{from} \PY{n+nn}{xgboost}\PY{n+nn}{.}\PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{XGBClassifier}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{data}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:}      gender education type locality religion         how\_often generation  \textbackslash{}
        0         f        general     town      yes        sev\_a\_year         9g   
        1         f   professional     town      yes        sev\_a\_year        10g   
        2         f         higher     town      yes        sev\_a\_year         3g   
        3         m   professional     town      yes             never         9g   
        4         f   professional     town      yes  min\_once\_a\_month         3g   
        5         m         higher     town      yes             never         7g   
        6         m        general     town      yes             never         2g   
        7         m         higher     town      yes             never         8g   
        8         f        general     town      yes  min\_once\_a\_month         1g   
        9         m   professional     town      yes             never         8g   
        10        f   professional     town      yes             never         7g   
        11        f   professional     town      yes        sev\_a\_year         6g   
        12        m   professional     town      yes             never         8g   
        13        m   professional     town      yes             never         4g   
        14        f        general     town      yes       once\_a\_week         3g   
        15        f        general     town      yes  min\_once\_a\_month         4g   
        16        f         higher     town      yes        sev\_a\_year         3g   
        17        f        general     town      yes  min\_once\_a\_month         4g   
        18        f   professional     town      yes        sev\_a\_year         2g   
        19        m        general     town      yes             never         8g   
        20        f   professional     town      yes  min\_once\_a\_month         3g   
        21        f   professional     town      yes        sev\_a\_year         5g   
        22        f   professional     town      yes        sev\_a\_year        10g   
        23        f   professional     town      yes  min\_once\_a\_month         7g   
        24        f        general     town      yes        sev\_a\_year         7g   
        25        m        general     town      yes             never         4g   
        26        f         higher     town      yes        sev\_a\_year         6g   
        27        m         higher     town      yes  min\_once\_a\_month         8g   
        28        f        general     town      yes  min\_once\_a\_month         3g   
        29        m   professional     town       no             never         5g   
        {\ldots}     {\ldots}            {\ldots}      {\ldots}      {\ldots}               {\ldots}        {\ldots}   
        5035      f         higher     city      yes        sev\_a\_year         4g   
        5036      m         higher     city      yes             never         7g   
        5037      f         higher     city      yes        sev\_a\_year         5g   
        5038      m   professional     city      yes        sev\_a\_year         2g   
        5039      m   professional     city      yes             never         6g   
        5040      m   professional  village      yes             never         7g   
        5041      m   professional  village       no             never         3g   
        5042      f         higher     city      yes        sev\_a\_year         2g   
        5043      f        general  village      yes             never         6g   
        5044      f        general     city       no             never         3g   
        5045      m         higher     city      yes             never         7g   
        5046      f   professional  village      yes        sev\_a\_year         3g   
        5047      m         higher     town      yes  min\_once\_a\_month        11g   
        5048      f   professional  village      yes             never         6g   
        5049      f         higher  village      yes  min\_once\_a\_month        11g   
        5050      f         higher     city      yes             never        10g   
        5051      f         higher  village      yes        sev\_a\_year         7g   
        5052      f   professional  village       no             never         8g   
        5053      m        general  village      yes             never         2g   
        5054      f        general  village      yes             never         9g   
        5055      f   professional     city      yes        sev\_a\_week         4g   
        5056      f   professional  village      yes             never         5g   
        5057      m   professional  village       no             never        10g   
        5058      f        general     city      yes        sev\_a\_year         7g   
        5059      m   professional     city      yes        sev\_a\_year         9g   
        5060      f   professional     city      yes             never         3g   
        5061      f         higher     city      yes  min\_once\_a\_month         2g   
        5062      m         higher     city       no             never         4g   
        5063      f        general     city      yes        sev\_a\_year         1g   
        5064      m         higher     city       no             never         3g   
        
              partner  marriage  break  divorce    {\ldots}      divorce work  \textbackslash{}
        0           0         1      0        0    {\ldots}                 n   
        1           0         1      0        0    {\ldots}                 >   
        2           0         1      0        0    {\ldots}                 >   
        3           1         0      0        0    {\ldots}                 >   
        4           0         1      0        0    {\ldots}                 >   
        5           0         1      0        0    {\ldots}                 >   
        6           0         1      0        0    {\ldots}                 >   
        7           1         1      1        0    {\ldots}                 >   
        8           0         1      0        0    {\ldots}                 >   
        9           0         1      0        0    {\ldots}                 >   
        10          0         1      0        0    {\ldots}                 >   
        11          0         1      0        0    {\ldots}                 >   
        12          0         1      0        0    {\ldots}                 >   
        13          0         1      0        0    {\ldots}                 >   
        14          0         0      0        0    {\ldots}                 n   
        15          0         1      0        0    {\ldots}                 >   
        16          0         0      0        0    {\ldots}                 >   
        17          0         0      0        0    {\ldots}                 >   
        18          1         0      0        0    {\ldots}                 >   
        19          0         1      0        0    {\ldots}                 >   
        20          0         1      0        0    {\ldots}                 >   
        21          1         1      0        0    {\ldots}                 >   
        22          0         1      0        0    {\ldots}                 n   
        23          0         1      0        0    {\ldots}                 >   
        24          1         1      0        0    {\ldots}                 >   
        25          0         1      0        0    {\ldots}                 >   
        26          0         1      0        0    {\ldots}                 >   
        27          0         1      0        0    {\ldots}                 >   
        28          0         1      0        0    {\ldots}                 >   
        29          0         1      0        0    {\ldots}                 >   
        {\ldots}       {\ldots}       {\ldots}    {\ldots}      {\ldots}    {\ldots}               {\ldots}   
        5035        0         0      0        0    {\ldots}                 n   
        5036        0         1      0        0    {\ldots}                 n   
        5037        1         1      0        0    {\ldots}                 n   
        5038        0         1      0        0    {\ldots}                 n   
        5039        1         0      0        0    {\ldots}                 n   
        5040        0         0      0        0    {\ldots}                 n   
        5041        0         1      0        0    {\ldots}                 n   
        5042        0         1      0        0    {\ldots}                 n   
        5043        1         1      0        0    {\ldots}                 n   
        5044        0         1      0        0    {\ldots}                 n   
        5045        0         1      0        0    {\ldots}                 n   
        5046        0         0      0        0    {\ldots}                 n   
        5047        0         0      0        0    {\ldots}                 n   
        5048        0         0      0        0    {\ldots}                 n   
        5049        0         1      0        0    {\ldots}                 n   
        5050        0         0      0        0    {\ldots}                 n   
        5051        0         1      0        0    {\ldots}                 n   
        5052        0         0      0        0    {\ldots}                 n   
        5053        0         1      0        0    {\ldots}                 n   
        5054        0         1      0        0    {\ldots}                 n   
        5055        0         1      0        0    {\ldots}                 n   
        5056        0         1      0        0    {\ldots}                 n   
        5057        0         0      0        0    {\ldots}                 n   
        5058        1         1      0        0    {\ldots}                 n   
        5059        0         0      0        0    {\ldots}                 n   
        5060        0         1      0        0    {\ldots}                 n   
        5061        0         1      0        1    {\ldots}                 <   
        5062        0         1      0        0    {\ldots}                 n   
        5063        0         1      0        0    {\ldots}                 n   
        5064        0         1      0        0    {\ldots}                 n   
        
              divorce separation from parents  divorce child  education work  \textbackslash{}
        0                                   >              >               <   
        1                                   >              >               >   
        2                                   >              n               >   
        3                                   >              >               <   
        4                                   >              n               =   
        5                                   >              n               <   
        6                                   >              n               =   
        7                                   >              >               >   
        8                                   >              n               <   
        9                                   >              n               <   
        10                                  n              >               <   
        11                                  n              >               <   
        12                                  >              n               <   
        13                                  n              >               <   
        14                                  >              >               <   
        15                                  >              n               <   
        16                                  >              >               >   
        17                                  >              n               >   
        18                                  >              >               =   
        19                                  >              n               <   
        20                                  n              >               >   
        21                                  >              >               <   
        22                                  >              >               <   
        23                                  >              n               <   
        24                                  >              >               >   
        25                                  >              n               <   
        26                                  n              >               >   
        27                                  >              >               >   
        28                                  >              n               <   
        29                                  >              n               <   
        {\ldots}                               {\ldots}            {\ldots}             {\ldots}   
        5035                                n              n               <   
        5036                                n              >               <   
        5037                                >              >               n   
        5038                                >              >               n   
        5039                                >              >               n   
        5040                                >              n               n   
        5041                                >              >               n   
        5042                                >              n               n   
        5043                                >              >               n   
        5044                                >              >               n   
        5045                                >              >               n   
        5046                                >              n               n   
        5047                                n              n               n   
        5048                                n              n               n   
        5049                                >              >               n   
        5050                                >              n               n   
        5051                                >              >               n   
        5052                                >              n               n   
        5053                                >              >               n   
        5054                                >              >               n   
        5055                                >              >               n   
        5056                                >              >               n   
        5057                                >              n               n   
        5058                                >              >               n   
        5059                                n              n               n   
        5060                                >              >               n   
        5061                                >              >               n   
        5062                                >              >               n   
        5063                                >              >               n   
        5064                                >              >               n   
        
              education separation from parents  education child  \textbackslash{}
        0                                     >                <   
        1                                     >                >   
        2                                     >                <   
        3                                     <                <   
        4                                     <                <   
        5                                     >                <   
        6                                     <                <   
        7                                     >                >   
        8                                     <                <   
        9                                     <                <   
        10                                    <                <   
        11                                    <                <   
        12                                    <                <   
        13                                    <                <   
        14                                    <                <   
        15                                    <                <   
        16                                    >                >   
        17                                    >                <   
        18                                    >                <   
        19                                    <                <   
        20                                    <                <   
        21                                    <                <   
        22                                    <                <   
        23                                    >                <   
        24                                    <                <   
        25                                    <                <   
        26                                    <                <   
        27                                    >                >   
        28                                    <                <   
        29                                    >                <   
        {\ldots}                                 {\ldots}              {\ldots}   
        5035                                  <                <   
        5036                                  <                >   
        5037                                  >                >   
        5038                                  >                >   
        5039                                  >                >   
        5040                                  >                n   
        5041                                  >                >   
        5042                                  >                n   
        5043                                  >                >   
        5044                                  >                >   
        5045                                  >                >   
        5046                                  >                n   
        5047                                  n                n   
        5048                                  n                n   
        5049                                  >                >   
        5050                                  >                n   
        5051                                  >                >   
        5052                                  >                n   
        5053                                  >                >   
        5054                                  >                >   
        5055                                  >                >   
        5056                                  >                >   
        5057                                  >                n   
        5058                                  >                >   
        5059                                  n                n   
        5060                                  >                >   
        5061                                  >                >   
        5062                                  >                >   
        5063                                  >                >   
        5064                                  >                >   
        
              work separation from parents  work child  separation from parents child  \textbackslash{}
        0                                >           >                              <   
        1                                <           <                              <   
        2                                <           <                              <   
        3                                >           <                              <   
        4                                <           <                              <   
        5                                >           <                              <   
        6                                <           <                              <   
        7                                >           <                              <   
        8                                <           <                              <   
        9                                <           <                              <   
        10                               <           <                              >   
        11                               <           <                              >   
        12                               <           <                              <   
        13                               <           <                              >   
        14                               >           >                              <   
        15                               >           <                              <   
        16                               <           <                              <   
        17                               =           <                              <   
        18                               >           <                              <   
        19                               <           <                              <   
        20                               <           <                              >   
        21                               <           <                              >   
        22                               >           >                              <   
        23                               >           <                              <   
        24                               <           <                              <   
        25                               <           <                              <   
        26                               <           <                              >   
        27                               >           >                              <   
        28                               <           <                              <   
        29                               >           <                              <   
        {\ldots}                            {\ldots}         {\ldots}                            {\ldots}   
        5035                             n           n                              n   
        5036                             n           >                              >   
        5037                             >           >                              <   
        5038                             >           >                              <   
        5039                             >           >                              <   
        5040                             >           n                              <   
        5041                             >           >                              <   
        5042                             >           n                              <   
        5043                             >           >                              <   
        5044                             >           >                              <   
        5045                             >           >                              <   
        5046                             >           n                              <   
        5047                             n           n                              n   
        5048                             n           n                              n   
        5049                             >           >                              <   
        5050                             >           n                              <   
        5051                             >           >                              <   
        5052                             >           n                              <   
        5053                             >           >                              <   
        5054                             >           >                              <   
        5055                             >           >                              <   
        5056                             >           >                              <   
        5057                             >           n                              <   
        5058                             >           >                              <   
        5059                             n           n                              n   
        5060                             >           >                              <   
        5061                             >           >                              <   
        5062                             >           >                              <   
        5063                             >           >                              <   
        5064                             >           >                              <   
        
                last\_ev  
        0          work  
        1     education  
        2         child  
        3            br  
        4         child  
        5         child  
        6         child  
        7           div  
        8         child  
        9         child  
        10          sep  
        11          sep  
        12        child  
        13          sep  
        14         work  
        15        child  
        16    education  
        17        child  
        18     marriage  
        19        child  
        20          sep  
        21          div  
        22         work  
        23        child  
        24           br  
        25        child  
        26          sep  
        27    education  
        28        child  
        29        child  
        {\ldots}         {\ldots}  
        5035       work  
        5036       work  
        5037       work  
        5038       work  
        5039       work  
        5040       work  
        5041       work  
        5042       work  
        5043       work  
        5044       work  
        5045       work  
        5046       work  
        5047       work  
        5048       work  
        5049       work  
        5050       work  
        5051       work  
        5052       work  
        5053       work  
        5054       work  
        5055       work  
        5056       work  
        5057       work  
        5058       work  
        5059       work  
        5060       work  
        5061       work  
        5062       work  
        5063       work  
        5064       work  
        
        [5065 rows x 51 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{data}\PY{o}{.}\PY{n}{last\PYZus{}ev}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:} child        1766
        education     760
        sep           682
        br            562
        div           473
        work          330
        marriage      251
        partner       241
        Name: last\_ev, dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{y} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{last\PYZus{}ev}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sep}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{br}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{div}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{7}\PY{p}{\PYZcb{}}\PY{p}{)}
        \PY{n}{X} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{last\PYZus{}ev}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{child.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sep\PYZus{}from\PYZus{}par.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{X}\PY{o}{.}\PY{n}{dtypes}\PY{p}{,}\PY{n}{X}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:} (gender                               object
         education type                       object
         locality                             object
         religion                             object
         how\_often                            object
         generation                           object
         partner                               int64
         marriage                              int64
         break                                 int64
         divorce                               int64
         child                                 int64
         sep\_from\_par                          int64
         work                                  int64
         education                             int64
         partner marriage                     object
         partner break                        object
         partner divorce                      object
         partner education                    object
         partner work                         object
         partner separation from parents      object
         partner child                        object
         marriage break                       object
         marriage divorce                     object
         marriage education                   object
         marriage work                        object
         marriage separation from parents     object
         marriage child                       object
         break divorce                        object
         break education                      object
         break work                           object
         break separation from parents        object
         break child                          object
         divorce education                    object
         divorce work                         object
         divorce separation from parents      object
         divorce child                        object
         education work                       object
         education separation from parents    object
         education child                      object
         work separation from parents         object
         work child                           object
         separation from parents child        object
         dtype: object, False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{num\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sep\PYZus{}from\PYZus{}par}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
        
        \PY{n}{cat\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gender}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education type}\PY{l+s+s2}{\PYZdq{}}          \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{locality}\PY{l+s+s2}{\PYZdq{}}         \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{religion}\PY{l+s+s2}{\PYZdq{}}        \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{how\PYZus{}often}\PY{l+s+s2}{\PYZdq{}}       \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{generation}\PY{l+s+s2}{\PYZdq{}}       \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner marriage}\PY{l+s+s2}{\PYZdq{}}      \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner break}\PY{l+s+s2}{\PYZdq{}}       \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner divorce}\PY{l+s+s2}{\PYZdq{}}      \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner education}\PY{l+s+s2}{\PYZdq{}}     \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner work}\PY{l+s+s2}{\PYZdq{}}    \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner separation from parents}\PY{l+s+s2}{\PYZdq{}}   \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner child}\PY{l+s+s2}{\PYZdq{}}  \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage break}\PY{l+s+s2}{\PYZdq{}}        \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage divorce}\PY{l+s+s2}{\PYZdq{}}       \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage education}\PY{l+s+s2}{\PYZdq{}}       \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage work}\PY{l+s+s2}{\PYZdq{}}      \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage separation from parents}\PY{l+s+s2}{\PYZdq{}}     \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage child}\PY{l+s+s2}{\PYZdq{}}     \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break divorce}\PY{l+s+s2}{\PYZdq{}}    \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break education}\PY{l+s+s2}{\PYZdq{}}   \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break work}\PY{l+s+s2}{\PYZdq{}}      \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break separation from parents}\PY{l+s+s2}{\PYZdq{}}  \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break child}\PY{l+s+s2}{\PYZdq{}}     \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce education}\PY{l+s+s2}{\PYZdq{}}     \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce work}\PY{l+s+s2}{\PYZdq{}}     \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce separation from parents}\PY{l+s+s2}{\PYZdq{}}    \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce child}\PY{l+s+s2}{\PYZdq{}}    \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education work}\PY{l+s+s2}{\PYZdq{}}    \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education separation from parents}\PY{l+s+s2}{\PYZdq{}}   \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education child}\PY{l+s+s2}{\PYZdq{}}  \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work separation from parents}\PY{l+s+s2}{\PYZdq{}}  \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work child}\PY{l+s+s2}{\PYZdq{}}  \PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{separation from parents child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{preprocessor} \PY{o}{=} \PY{n}{ColumnTransformer}\PY{p}{(}\PY{p}{[}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{numerical}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{passthrough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{num\PYZus{}features}\PY{p}{)}\PY{p}{,} 
                                          \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{categorical}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{OneHotEncoder}\PY{p}{(}\PY{n}{sparse}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{handle\PYZus{}unknown}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ignore}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
                                           \PY{n}{cat\PYZus{}features}\PY{p}{)}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{X}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{X}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} (False, gender                               0
          education type                       0
          locality                             0
          religion                             0
          how\_often                            0
          generation                           0
          partner                              0
          marriage                             0
          break                                0
          divorce                              0
          child                                0
          sep\_from\_par                         0
          work                                 0
          education                            0
          partner marriage                     0
          partner break                        0
          partner divorce                      0
          partner education                    0
          partner work                         0
          partner separation from parents      0
          partner child                        0
          marriage break                       0
          marriage divorce                     0
          marriage education                   0
          marriage work                        0
          marriage separation from parents     0
          marriage child                       0
          break divorce                        0
          break education                      0
          break work                           0
          break separation from parents        0
          break child                          0
          divorce education                    0
          divorce work                         0
          divorce separation from parents      0
          divorce child                        0
          education work                       0
          education separation from parents    0
          education child                      0
          work separation from parents         0
          work child                           0
          separation from parents child        0
          dtype: int64)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{} Logistic Regression}
         \PY{n}{lr\PYZus{}model} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{p}{[}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{preprocessor}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{preprocessor}\PY{p}{)}\PY{p}{,} 
                              \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{class\PYZus{}weight}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{balanced}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{solver}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{liblinear}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Decision Tree}
         \PY{n}{dt\PYZus{}model} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{p}{[}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{preprocessor}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{preprocessor}\PY{p}{)}\PY{p}{,} 
                              \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{class\PYZus{}weight}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{balanced}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Random Forest}
         \PY{n}{rf\PYZus{}model} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{p}{[}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{preprocessor}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{preprocessor}\PY{p}{)}\PY{p}{,} 
                              \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{class\PYZus{}weight}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{balanced}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} XGBoost}
         \PY{n}{xgb\PYZus{}model} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{p}{[}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{preprocessor}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{preprocessor}\PY{p}{)}\PY{p}{,} 
                               \PY{c+c1}{\PYZsh{} Add a scale\PYZus{}pos\PYZus{}weight to make it balanced}
                               \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{scale\PYZus{}pos\PYZus{}weight}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{stratify}\PY{o}{=}\PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{gs} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{lr\PYZus{}model}\PY{p}{,} \PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}\PYZus{}C}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{1.3}\PY{p}{,} \PY{l+m+mf}{1.5}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{accuracy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{gs}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/anaconda3/lib/python3.7/site-packages/sklearn/linear\_model/logistic.py:460: FutureWarning: Default multi\_class will be changed to 'auto' in 0.22. Specify the multi\_class option to silence this warning.
  "this warning.", FutureWarning)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} GridSearchCV(cv=5, error\_score='raise-deprecating',
                estimator=Pipeline(memory=None,
              steps=[('preprocessor', ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                  transformer\_weights=None,
                  transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEnco{\ldots}alty='l2', random\_state=42,
                   solver='liblinear', tol=0.0001, verbose=0, warm\_start=False))]),
                fit\_params=None, iid='warn', n\_jobs=-1,
                param\_grid=\{'model\_\_C': [1, 1.3, 1.5]\}, pre\_dispatch='2*n\_jobs',
                refit=True, return\_train\_score='warn', scoring='accuracy',
                verbose=0)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}score\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
\{'model\_\_C': 1.5\}
0.8569816643159379

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{set\PYZus{}params}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:} Pipeline(memory=None,
              steps=[('preprocessor', ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                  transformer\_weights=None,
                  transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEnco{\ldots}alty='l2', random\_state=42,
                   solver='liblinear', tol=0.0001, verbose=0, warm\_start=False))])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{get\PYZus{}params}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:} \{'memory': None,
          'steps': [('preprocessor',
            ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                     transformer\_weights=None,
                     transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEncoder(categorical\_features=None, categories=None,
                   dtype=<class 'numpy.float64'>, handle\_unknown='ignore',
                   n\_values=None, sparse{\ldots} 'education child', 'work separation from parents', 'work child', 'separation from parents child'])])),
           ('model', LogisticRegression(C=1.5, class\_weight='balanced', dual=False,
                      fit\_intercept=True, intercept\_scaling=1, max\_iter=100,
                      multi\_class='warn', n\_jobs=None, penalty='l2', random\_state=42,
                      solver='liblinear', tol=0.0001, verbose=0, warm\_start=False))],
          'preprocessor': ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                   transformer\_weights=None,
                   transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEncoder(categorical\_features=None, categories=None,
                 dtype=<class 'numpy.float64'>, handle\_unknown='ignore',
                 n\_values=None, sparse{\ldots} 'education child', 'work separation from parents', 'work child', 'separation from parents child'])]),
          'model': LogisticRegression(C=1.5, class\_weight='balanced', dual=False,
                    fit\_intercept=True, intercept\_scaling=1, max\_iter=100,
                    multi\_class='warn', n\_jobs=None, penalty='l2', random\_state=42,
                    solver='liblinear', tol=0.0001, verbose=0, warm\_start=False),
          'preprocessor\_\_n\_jobs': None,
          'preprocessor\_\_remainder': 'drop',
          'preprocessor\_\_sparse\_threshold': 0.3,
          'preprocessor\_\_transformer\_weights': None,
          'preprocessor\_\_transformers': [('numerical',
            'passthrough',
            ['partner',
             'marriage',
             'break',
             'divorce',
             'child',
             'sep\_from\_par',
             'work',
             'education']),
           ('categorical', OneHotEncoder(categorical\_features=None, categories=None,
                   dtype=<class 'numpy.float64'>, handle\_unknown='ignore',
                   n\_values=None, sparse=False), ['gender',
             'education type',
             'locality',
             'religion',
             'how\_often',
             'generation',
             'partner marriage',
             'partner break',
             'partner divorce',
             'partner education',
             'partner work',
             'partner separation from parents',
             'partner child',
             'marriage break',
             'marriage divorce',
             'marriage education',
             'marriage work',
             'marriage separation from parents',
             'marriage child',
             'break divorce',
             'break education',
             'break work',
             'break separation from parents',
             'break child',
             'divorce education',
             'divorce work',
             'divorce separation from parents',
             'divorce child',
             'education work',
             'education separation from parents',
             'education child',
             'work separation from parents',
             'work child',
             'separation from parents child'])],
          'preprocessor\_\_numerical': 'passthrough',
          'preprocessor\_\_categorical': OneHotEncoder(categorical\_features=None, categories=None,
                 dtype=<class 'numpy.float64'>, handle\_unknown='ignore',
                 n\_values=None, sparse=False),
          'preprocessor\_\_categorical\_\_categorical\_features': None,
          'preprocessor\_\_categorical\_\_categories': None,
          'preprocessor\_\_categorical\_\_dtype': numpy.float64,
          'preprocessor\_\_categorical\_\_handle\_unknown': 'ignore',
          'preprocessor\_\_categorical\_\_n\_values': None,
          'preprocessor\_\_categorical\_\_sparse': False,
          'model\_\_C': 1.5,
          'model\_\_class\_weight': 'balanced',
          'model\_\_dual': False,
          'model\_\_fit\_intercept': True,
          'model\_\_intercept\_scaling': 1,
          'model\_\_max\_iter': 100,
          'model\_\_multi\_class': 'warn',
          'model\_\_n\_jobs': None,
          'model\_\_penalty': 'l2',
          'model\_\_random\_state': 42,
          'model\_\_solver': 'liblinear',
          'model\_\_tol': 0.0001,
          'model\_\_verbose': 0,
          'model\_\_warm\_start': False\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/anaconda3/lib/python3.7/site-packages/sklearn/linear\_model/logistic.py:460: FutureWarning: Default multi\_class will be changed to 'auto' in 0.22. Specify the multi\_class option to silence this warning.
  "this warning.", FutureWarning)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:} Pipeline(memory=None,
              steps=[('preprocessor', ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                  transformer\_weights=None,
                  transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEnco{\ldots}alty='l2', random\_state=42,
                   solver='liblinear', tol=0.0001, verbose=0, warm\_start=False))])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:} 0.8618421052631579
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

           0       0.94      0.91      0.92       530
           1       0.99      0.95      0.97       228
           2       0.87      0.95      0.91       205
           3       0.79      0.86      0.82       169
           4       0.79      0.68      0.73       142
           5       0.84      0.97      0.90        99
           6       0.49      0.64      0.55        75
           7       0.72      0.46      0.56        72

   micro avg       0.86      0.86      0.86      1520
   macro avg       0.80      0.80      0.80      1520
weighted avg       0.87      0.86      0.86      1520


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{k+kn}{import} \PY{n+nn}{eli5}
         \PY{n}{eli5}\PY{o}{.}\PY{n}{show\PYZus{}weights}\PY{p}{(}\PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{preprocessor} \PY{o}{=} \PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{preprocessor}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{ohe\PYZus{}categories} \PY{o}{=} \PY{n}{preprocessor}\PY{o}{.}\PY{n}{named\PYZus{}transformers\PYZus{}}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{categorical}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{categories\PYZus{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{new\PYZus{}ohe\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}col\PYZcb{}}\PY{l+s+s2}{\PYZus{}\PYZus{}}\PY{l+s+si}{\PYZob{}val\PYZcb{}}\PY{l+s+s2}{\PYZdq{}} \PY{k}{for} \PY{n}{col}\PY{p}{,} \PY{n}{vals} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{cat\PYZus{}features}\PY{p}{,} \PY{n}{ohe\PYZus{}categories}\PY{p}{)} \PY{k}{for} \PY{n}{val} \PY{o+ow}{in} \PY{n}{vals}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{all\PYZus{}features} \PY{o}{=} \PY{n}{num\PYZus{}features} \PY{o}{+} \PY{n}{new\PYZus{}ohe\PYZus{}features}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{preprocessor}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{all\PYZus{}features}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}26}]:}    partner  marriage  break  divorce  child  sep\_from\_par  work  education  \textbackslash{}
         0      1.0       1.0    0.0      0.0    1.0           1.0   1.0        1.0   
         1      1.0       0.0    0.0      0.0    1.0           1.0   1.0        1.0   
         2      0.0       0.0    0.0      0.0    1.0           1.0   1.0        0.0   
         3      1.0       1.0    0.0      1.0    1.0           1.0   1.0        1.0   
         4      0.0       1.0    0.0      0.0    0.0           1.0   1.0        1.0   
         
            gender\_\_f  gender\_\_m                {\ldots}                 \textbackslash{}
         0        0.0        1.0                {\ldots}                  
         1        1.0        0.0                {\ldots}                  
         2        1.0        0.0                {\ldots}                  
         3        1.0        0.0                {\ldots}                  
         4        0.0        1.0                {\ldots}                  
         
            work separation from parents\_\_>  work separation from parents\_\_n  \textbackslash{}
         0                              1.0                              0.0   
         1                              1.0                              0.0   
         2                              0.0                              0.0   
         3                              0.0                              0.0   
         4                              0.0                              0.0   
         
            work child\_\_<  work child\_\_=  work child\_\_>  work child\_\_n  \textbackslash{}
         0            1.0            0.0            0.0            0.0   
         1            1.0            0.0            0.0            0.0   
         2            1.0            0.0            0.0            0.0   
         3            1.0            0.0            0.0            0.0   
         4            1.0            0.0            0.0            0.0   
         
            separation from parents child\_\_<  separation from parents child\_\_=  \textbackslash{}
         0                               1.0                               0.0   
         1                               1.0                               0.0   
         2                               1.0                               0.0   
         3                               0.0                               0.0   
         4                               1.0                               0.0   
         
            separation from parents child\_\_>  separation from parents child\_\_n  
         0                               0.0                               0.0  
         1                               0.0                               0.0  
         2                               0.0                               0.0  
         3                               1.0                               0.0  
         4                               0.0                               0.0  
         
         [5 rows x 137 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{eli5}\PY{o}{.}\PY{n}{show\PYZus{}weights}\PY{p}{(}\PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{all\PYZus{}features}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}27}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{4}
         \PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}28}]:}      gender education type locality religion   how\_often generation  partner  \textbackslash{}
         4087      m   professional     city      yes  sev\_a\_year        10g        0   
         
               marriage  break  divorce              {\ldots}               \textbackslash{}
         4087         1      0        0              {\ldots}                
         
               divorce education  divorce work  divorce separation from parents  \textbackslash{}
         4087                  >             >                                >   
         
               divorce child education work education separation from parents  \textbackslash{}
         4087              n              <                                 <   
         
              education child work separation from parents work child  \textbackslash{}
         4087               <                            <          <   
         
              separation from parents child  
         4087                             <  
         
         [1 rows x 42 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{y\PYZus{}test}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:} 0
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{eli5}\PY{o}{.}\PY{n}{show\PYZus{}prediction}\PY{p}{(}\PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} 
                              \PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{preprocessor}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}
                              \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{all\PYZus{}features}\PY{p}{,} \PY{n}{show\PYZus{}feature\PYZus{}values}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}30}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{gs} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{dt\PYZus{}model}\PY{p}{,} \PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{]}\PY{p}{,} 
                                      \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}\PYZus{}min\PYZus{}samples\PYZus{}split}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{,} 
                           \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{accuracy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{gs}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}31}]:} GridSearchCV(cv=5, error\_score='raise-deprecating',
                estimator=Pipeline(memory=None,
              steps=[('preprocessor', ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                  transformer\_weights=None,
                  transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEnco{\ldots}      min\_weight\_fraction\_leaf=0.0, presort=False, random\_state=None,
                     splitter='best'))]),
                fit\_params=None, iid='warn', n\_jobs=-1,
                param\_grid=\{'model\_\_max\_depth': [3, 5, 7], 'model\_\_min\_samples\_split': [2, 5]\},
                pre\_dispatch='2*n\_jobs', refit=True, return\_train\_score='warn',
                scoring='accuracy', verbose=0)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}score\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
\{'model\_\_max\_depth': 7, 'model\_\_min\_samples\_split': 2\}
0.8225669957686883

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{dt\PYZus{}model}\PY{o}{.}\PY{n}{set\PYZus{}params}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}33}]:} Pipeline(memory=None,
              steps=[('preprocessor', ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                  transformer\_weights=None,
                  transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEnco{\ldots}      min\_weight\_fraction\_leaf=0.0, presort=False, random\_state=None,
                     splitter='best'))])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{dt\PYZus{}model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
         \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{dt\PYZus{}model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} 0.8223684210526315
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

           0       0.95      0.82      0.88       530
           1       0.98      0.90      0.94       228
           2       0.82      0.94      0.87       205
           3       0.76      0.80      0.78       169
           4       0.79      0.73      0.75       142
           5       0.82      0.89      0.85        99
           6       0.38      0.80      0.52        75
           7       0.73      0.46      0.56        72

   micro avg       0.82      0.82      0.82      1520
   macro avg       0.78      0.79      0.77      1520
weighted avg       0.85      0.82      0.83      1520


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{eli5}\PY{o}{.}\PY{n}{show\PYZus{}weights}\PY{p}{(}\PY{n}{dt\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{all\PYZus{}features}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}37}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{eli5}\PY{o}{.}\PY{n}{show\PYZus{}prediction}\PY{p}{(}\PY{n}{dt\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} 
                              \PY{n}{dt\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{preprocessor}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}
                              \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{all\PYZus{}features}\PY{p}{,} \PY{n}{show\PYZus{}feature\PYZus{}values}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}38}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{gs} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{rf\PYZus{}model}\PY{p}{,} \PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{]}\PY{p}{,} 
                                      \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}\PYZus{}min\PYZus{}samples\PYZus{}split}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{,} 
                           \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{accuracy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{gs}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}39}]:} GridSearchCV(cv=5, error\_score='raise-deprecating',
                estimator=Pipeline(memory=None,
              steps=[('preprocessor', ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                  transformer\_weights=None,
                  transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEnco{\ldots}ators=100, n\_jobs=-1, oob\_score=False,
                     random\_state=None, verbose=0, warm\_start=False))]),
                fit\_params=None, iid='warn', n\_jobs=-1,
                param\_grid=\{'model\_\_max\_depth': [10, 15], 'model\_\_min\_samples\_split': [5, 10]\},
                pre\_dispatch='2*n\_jobs', refit=True, return\_train\_score='warn',
                scoring='accuracy', verbose=0)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}score\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
\{'model\_\_max\_depth': 15, 'model\_\_min\_samples\_split': 5\}
0.8493653032440056

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{rf\PYZus{}model}\PY{o}{.}\PY{n}{set\PYZus{}params}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}41}]:} Pipeline(memory=None,
              steps=[('preprocessor', ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                  transformer\_weights=None,
                  transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEnco{\ldots}ators=100, n\_jobs=-1, oob\_score=False,
                     random\_state=None, verbose=0, warm\_start=False))])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{rf\PYZus{}model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
         \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{rf\PYZus{}model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}43}]:} 0.8585526315789473
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

           0       0.92      0.92      0.92       530
           1       0.97      0.94      0.96       228
           2       0.87      0.91      0.89       205
           3       0.80      0.81      0.80       169
           4       0.77      0.73      0.75       142
           5       0.82      0.95      0.88        99
           6       0.50      0.69      0.58        75
           7       0.89      0.46      0.61        72

   micro avg       0.86      0.86      0.86      1520
   macro avg       0.82      0.80      0.80      1520
weighted avg       0.87      0.86      0.86      1520


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{eli5}\PY{o}{.}\PY{n}{show\PYZus{}weights}\PY{p}{(}\PY{n}{rf\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} 
                           \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{all\PYZus{}features}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{gs} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{xgb\PYZus{}model}\PY{p}{,} \PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}
                                       \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}\PYZus{}min\PYZus{}child\PYZus{}weight}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}
                                       \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{25}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{,}
                           \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{accuracy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{gs}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:} GridSearchCV(cv=5, error\_score='raise-deprecating',
                estimator=Pipeline(memory=None,
              steps=[('preprocessor', ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                  transformer\_weights=None,
                  transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEnco{\ldots}\_lambda=1,
                scale\_pos\_weight=-1.081934846989141, seed=None, silent=True,
                subsample=1))]),
                fit\_params=None, iid='warn', n\_jobs=-1,
                param\_grid=\{'model\_\_max\_depth': [5, 10], 'model\_\_min\_child\_weight': [5, 10], 'model\_\_n\_estimators': [25]\},
                pre\_dispatch='2*n\_jobs', refit=True, return\_train\_score='warn',
                scoring='accuracy', verbose=0)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}score\PYZus{}}\PY{p}{)}
         \PY{n}{xgb\PYZus{}model}\PY{o}{.}\PY{n}{set\PYZus{}params}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{gs}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
         \PY{n}{xgb\PYZus{}model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
\{'model\_\_max\_depth': 5, 'model\_\_min\_child\_weight': 10, 'model\_\_n\_estimators': 25\}
0.8758815232722144

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}47}]:} Pipeline(memory=None,
              steps=[('preprocessor', ColumnTransformer(n\_jobs=None, remainder='drop', sparse\_threshold=0.3,
                  transformer\_weights=None,
                  transformers=[('numerical', 'passthrough', ['partner', 'marriage', 'break', 'divorce', 'child', 'sep\_from\_par', 'work', 'education']), ('categorical', OneHotEnco{\ldots}=0, reg\_lambda=1, scale\_pos\_weight=-1.081934846989141,
                seed=None, silent=True, subsample=1))])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{xgb\PYZus{}model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:} 0.8743421052631579
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

           0       0.89      0.97      0.93       530
           1       0.99      0.95      0.97       228
           2       0.89      0.92      0.90       205
           3       0.78      0.85      0.81       169
           4       0.80      0.73      0.76       142
           5       0.83      0.98      0.90        99
           6       0.70      0.49      0.58        75
           7       1.00      0.40      0.57        72

   micro avg       0.87      0.87      0.87      1520
   macro avg       0.86      0.79      0.80      1520
weighted avg       0.88      0.87      0.87      1520


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{k+kn}{from} \PY{n+nn}{lime}\PY{n+nn}{.}\PY{n+nn}{lime\PYZus{}tabular} \PY{k}{import} \PY{n}{LimeTabularExplainer}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{categorical\PYZus{}names} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{cat\PYZus{}features}\PY{p}{:}
             \PY{n}{categorical\PYZus{}names}\PY{p}{[}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{get\PYZus{}loc}\PY{p}{(}\PY{n}{col}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{new\PYZus{}col}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} 
                                                                \PY{k}{for} \PY{n}{new\PYZus{}col} \PY{o+ow}{in} \PY{n}{new\PYZus{}ohe\PYZus{}features} 
                                                                \PY{k}{if} \PY{n}{new\PYZus{}col}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{col}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{categorical\PYZus{}names}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}53}]:} \{0: ['f', 'm'],
          1: ['general', 'higher', 'professional'],
          2: ['city', 'town', 'village'],
          3: ['no', 'yes'],
          4: ['min\_once\_a\_month', 'never', 'once\_a\_week', 'sev\_a\_week', 'sev\_a\_year'],
          5: ['10g', '11g', '1g', '2g', '3g', '4g', '5g', '6g', '7g', '8g', '9g'],
          14: ['<', '>', 'n'],
          15: ['<', 'n'],
          16: ['<', '=', '>', 'n'],
          17: ['<', '=', '>', 'n'],
          18: ['<', '=', '>', 'n'],
          19: ['<', '=', '>', 'n'],
          20: ['<', '=', '>', 'n'],
          21: ['<', '>', 'n'],
          22: ['<', 'n'],
          23: ['<', '=', '>', 'n'],
          24: ['<', '=', '>', 'n'],
          25: ['<', '=', '>', 'n'],
          26: ['<', '=', '>', 'n'],
          27: ['<', '=', '>', 'n'],
          28: ['<', '=', '>', 'n'],
          29: ['<', '=', '>', 'n'],
          30: ['<', '>', 'n'],
          31: ['<', '=', '>', 'n'],
          32: ['<', '>', 'n'],
          33: ['<', '>', 'n'],
          34: ['<', '=', '>', 'n'],
          35: ['<', '=', '>', 'n'],
          36: ['<', '=', '>', 'n'],
          37: ['<', '=', '>', 'n'],
          38: ['<', '=', '>', 'n'],
          39: ['<', '=', '>', 'n'],
          40: ['<', '=', '>', 'n'],
          41: ['<', '=', '>', 'n']\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n}{clean\PYZus{}set} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZlt{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{1} \PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{=}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{0} \PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+m+mi}{1} \PY{p}{\PYZcb{}}
         \PY{n}{clean\PYZus{}set}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}63}]:} \{'<': 0, '>': 1, '=': 0, 'n': 1\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{data}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}58}]:}      gender education type locality religion         how\_often generation  \textbackslash{}
         0         f        general     town      yes        sev\_a\_year         9g   
         1         f   professional     town      yes        sev\_a\_year        10g   
         2         f         higher     town      yes        sev\_a\_year         3g   
         3         m   professional     town      yes             never         9g   
         4         f   professional     town      yes  min\_once\_a\_month         3g   
         5         m         higher     town      yes             never         7g   
         6         m        general     town      yes             never         2g   
         7         m         higher     town      yes             never         8g   
         8         f        general     town      yes  min\_once\_a\_month         1g   
         9         m   professional     town      yes             never         8g   
         10        f   professional     town      yes             never         7g   
         11        f   professional     town      yes        sev\_a\_year         6g   
         12        m   professional     town      yes             never         8g   
         13        m   professional     town      yes             never         4g   
         14        f        general     town      yes       once\_a\_week         3g   
         15        f        general     town      yes  min\_once\_a\_month         4g   
         16        f         higher     town      yes        sev\_a\_year         3g   
         17        f        general     town      yes  min\_once\_a\_month         4g   
         18        f   professional     town      yes        sev\_a\_year         2g   
         19        m        general     town      yes             never         8g   
         20        f   professional     town      yes  min\_once\_a\_month         3g   
         21        f   professional     town      yes        sev\_a\_year         5g   
         22        f   professional     town      yes        sev\_a\_year        10g   
         23        f   professional     town      yes  min\_once\_a\_month         7g   
         24        f        general     town      yes        sev\_a\_year         7g   
         25        m        general     town      yes             never         4g   
         26        f         higher     town      yes        sev\_a\_year         6g   
         27        m         higher     town      yes  min\_once\_a\_month         8g   
         28        f        general     town      yes  min\_once\_a\_month         3g   
         29        m   professional     town       no             never         5g   
         {\ldots}     {\ldots}            {\ldots}      {\ldots}      {\ldots}               {\ldots}        {\ldots}   
         5035      f         higher     city      yes        sev\_a\_year         4g   
         5036      m         higher     city      yes             never         7g   
         5037      f         higher     city      yes        sev\_a\_year         5g   
         5038      m   professional     city      yes        sev\_a\_year         2g   
         5039      m   professional     city      yes             never         6g   
         5040      m   professional  village      yes             never         7g   
         5041      m   professional  village       no             never         3g   
         5042      f         higher     city      yes        sev\_a\_year         2g   
         5043      f        general  village      yes             never         6g   
         5044      f        general     city       no             never         3g   
         5045      m         higher     city      yes             never         7g   
         5046      f   professional  village      yes        sev\_a\_year         3g   
         5047      m         higher     town      yes  min\_once\_a\_month        11g   
         5048      f   professional  village      yes             never         6g   
         5049      f         higher  village      yes  min\_once\_a\_month        11g   
         5050      f         higher     city      yes             never        10g   
         5051      f         higher  village      yes        sev\_a\_year         7g   
         5052      f   professional  village       no             never         8g   
         5053      m        general  village      yes             never         2g   
         5054      f        general  village      yes             never         9g   
         5055      f   professional     city      yes        sev\_a\_week         4g   
         5056      f   professional  village      yes             never         5g   
         5057      m   professional  village       no             never        10g   
         5058      f        general     city      yes        sev\_a\_year         7g   
         5059      m   professional     city      yes        sev\_a\_year         9g   
         5060      f   professional     city      yes             never         3g   
         5061      f         higher     city      yes  min\_once\_a\_month         2g   
         5062      m         higher     city       no             never         4g   
         5063      f        general     city      yes        sev\_a\_year         1g   
         5064      m         higher     city       no             never         3g   
         
               partner  marriage  break  divorce   {\ldots}     \textbackslash{}
         0           0         1      0        0   {\ldots}      
         1           0         1      0        0   {\ldots}      
         2           0         1      0        0   {\ldots}      
         3           1         0      0        0   {\ldots}      
         4           0         1      0        0   {\ldots}      
         5           0         1      0        0   {\ldots}      
         6           0         1      0        0   {\ldots}      
         7           1         1      1        0   {\ldots}      
         8           0         1      0        0   {\ldots}      
         9           0         1      0        0   {\ldots}      
         10          0         1      0        0   {\ldots}      
         11          0         1      0        0   {\ldots}      
         12          0         1      0        0   {\ldots}      
         13          0         1      0        0   {\ldots}      
         14          0         0      0        0   {\ldots}      
         15          0         1      0        0   {\ldots}      
         16          0         0      0        0   {\ldots}      
         17          0         0      0        0   {\ldots}      
         18          1         0      0        0   {\ldots}      
         19          0         1      0        0   {\ldots}      
         20          0         1      0        0   {\ldots}      
         21          1         1      0        0   {\ldots}      
         22          0         1      0        0   {\ldots}      
         23          0         1      0        0   {\ldots}      
         24          1         1      0        0   {\ldots}      
         25          0         1      0        0   {\ldots}      
         26          0         1      0        0   {\ldots}      
         27          0         1      0        0   {\ldots}      
         28          0         1      0        0   {\ldots}      
         29          0         1      0        0   {\ldots}      
         {\ldots}       {\ldots}       {\ldots}    {\ldots}      {\ldots}   {\ldots}      
         5035        0         0      0        0   {\ldots}      
         5036        0         1      0        0   {\ldots}      
         5037        1         1      0        0   {\ldots}      
         5038        0         1      0        0   {\ldots}      
         5039        1         0      0        0   {\ldots}      
         5040        0         0      0        0   {\ldots}      
         5041        0         1      0        0   {\ldots}      
         5042        0         1      0        0   {\ldots}      
         5043        1         1      0        0   {\ldots}      
         5044        0         1      0        0   {\ldots}      
         5045        0         1      0        0   {\ldots}      
         5046        0         0      0        0   {\ldots}      
         5047        0         0      0        0   {\ldots}      
         5048        0         0      0        0   {\ldots}      
         5049        0         1      0        0   {\ldots}      
         5050        0         0      0        0   {\ldots}      
         5051        0         1      0        0   {\ldots}      
         5052        0         0      0        0   {\ldots}      
         5053        0         1      0        0   {\ldots}      
         5054        0         1      0        0   {\ldots}      
         5055        0         1      0        0   {\ldots}      
         5056        0         1      0        0   {\ldots}      
         5057        0         0      0        0   {\ldots}      
         5058        1         1      0        0   {\ldots}      
         5059        0         0      0        0   {\ldots}      
         5060        0         1      0        0   {\ldots}      
         5061        0         1      0        1   {\ldots}      
         5062        0         1      0        0   {\ldots}      
         5063        0         1      0        0   {\ldots}      
         5064        0         1      0        0   {\ldots}      
         
               divorce separation from parents  divorce child  education work  \textbackslash{}
         0                                   >              >               <   
         1                                   >              >               >   
         2                                   >              n               >   
         3                                   >              >               <   
         4                                   >              n               =   
         5                                   >              n               <   
         6                                   >              n               =   
         7                                   >              >               >   
         8                                   >              n               <   
         9                                   >              n               <   
         10                                  n              >               <   
         11                                  n              >               <   
         12                                  >              n               <   
         13                                  n              >               <   
         14                                  >              >               <   
         15                                  >              n               <   
         16                                  >              >               >   
         17                                  >              n               >   
         18                                  >              >               =   
         19                                  >              n               <   
         20                                  n              >               >   
         21                                  >              >               <   
         22                                  >              >               <   
         23                                  >              n               <   
         24                                  >              >               >   
         25                                  >              n               <   
         26                                  n              >               >   
         27                                  >              >               >   
         28                                  >              n               <   
         29                                  >              n               <   
         {\ldots}                               {\ldots}            {\ldots}             {\ldots}   
         5035                                n              n               <   
         5036                                n              >               <   
         5037                                >              >               n   
         5038                                >              >               n   
         5039                                >              >               n   
         5040                                >              n               n   
         5041                                >              >               n   
         5042                                >              n               n   
         5043                                >              >               n   
         5044                                >              >               n   
         5045                                >              >               n   
         5046                                >              n               n   
         5047                                n              n               n   
         5048                                n              n               n   
         5049                                >              >               n   
         5050                                >              n               n   
         5051                                >              >               n   
         5052                                >              n               n   
         5053                                >              >               n   
         5054                                >              >               n   
         5055                                >              >               n   
         5056                                >              >               n   
         5057                                >              n               n   
         5058                                >              >               n   
         5059                                n              n               n   
         5060                                >              >               n   
         5061                                >              >               n   
         5062                                >              >               n   
         5063                                >              >               n   
         5064                                >              >               n   
         
               education separation from parents  education child  \textbackslash{}
         0                                     >                <   
         1                                     >                >   
         2                                     >                <   
         3                                     <                <   
         4                                     <                <   
         5                                     >                <   
         6                                     <                <   
         7                                     >                >   
         8                                     <                <   
         9                                     <                <   
         10                                    <                <   
         11                                    <                <   
         12                                    <                <   
         13                                    <                <   
         14                                    <                <   
         15                                    <                <   
         16                                    >                >   
         17                                    >                <   
         18                                    >                <   
         19                                    <                <   
         20                                    <                <   
         21                                    <                <   
         22                                    <                <   
         23                                    >                <   
         24                                    <                <   
         25                                    <                <   
         26                                    <                <   
         27                                    >                >   
         28                                    <                <   
         29                                    >                <   
         {\ldots}                                 {\ldots}              {\ldots}   
         5035                                  <                <   
         5036                                  <                >   
         5037                                  >                >   
         5038                                  >                >   
         5039                                  >                >   
         5040                                  >                n   
         5041                                  >                >   
         5042                                  >                n   
         5043                                  >                >   
         5044                                  >                >   
         5045                                  >                >   
         5046                                  >                n   
         5047                                  n                n   
         5048                                  n                n   
         5049                                  >                >   
         5050                                  >                n   
         5051                                  >                >   
         5052                                  >                n   
         5053                                  >                >   
         5054                                  >                >   
         5055                                  >                >   
         5056                                  >                >   
         5057                                  >                n   
         5058                                  >                >   
         5059                                  n                n   
         5060                                  >                >   
         5061                                  >                >   
         5062                                  >                >   
         5063                                  >                >   
         5064                                  >                >   
         
               work separation from parents  work child  separation from parents child  \textbackslash{}
         0                                >           >                              <   
         1                                <           <                              <   
         2                                <           <                              <   
         3                                >           <                              <   
         4                                <           <                              <   
         5                                >           <                              <   
         6                                <           <                              <   
         7                                >           <                              <   
         8                                <           <                              <   
         9                                <           <                              <   
         10                               <           <                              >   
         11                               <           <                              >   
         12                               <           <                              <   
         13                               <           <                              >   
         14                               >           >                              <   
         15                               >           <                              <   
         16                               <           <                              <   
         17                               =           <                              <   
         18                               >           <                              <   
         19                               <           <                              <   
         20                               <           <                              >   
         21                               <           <                              >   
         22                               >           >                              <   
         23                               >           <                              <   
         24                               <           <                              <   
         25                               <           <                              <   
         26                               <           <                              >   
         27                               >           >                              <   
         28                               <           <                              <   
         29                               >           <                              <   
         {\ldots}                            {\ldots}         {\ldots}                            {\ldots}   
         5035                             n           n                              n   
         5036                             n           >                              >   
         5037                             >           >                              <   
         5038                             >           >                              <   
         5039                             >           >                              <   
         5040                             >           n                              <   
         5041                             >           >                              <   
         5042                             >           n                              <   
         5043                             >           >                              <   
         5044                             >           >                              <   
         5045                             >           >                              <   
         5046                             >           n                              <   
         5047                             n           n                              n   
         5048                             n           n                              n   
         5049                             >           >                              <   
         5050                             >           n                              <   
         5051                             >           >                              <   
         5052                             >           n                              <   
         5053                             >           >                              <   
         5054                             >           >                              <   
         5055                             >           >                              <   
         5056                             >           >                              <   
         5057                             >           n                              <   
         5058                             >           >                              <   
         5059                             n           n                              n   
         5060                             >           >                              <   
         5061                             >           >                              <   
         5062                             >           >                              <   
         5063                             >           >                              <   
         5064                             >           >                              <   
         
                 last\_ev  gender1  
         0          work        0  
         1     education        0  
         2         child        0  
         3            br        1  
         4         child        0  
         5         child        1  
         6         child        1  
         7           div        1  
         8         child        0  
         9         child        1  
         10          sep        0  
         11          sep        0  
         12        child        1  
         13          sep        1  
         14         work        0  
         15        child        0  
         16    education        0  
         17        child        0  
         18     marriage        0  
         19        child        1  
         20          sep        0  
         21          div        0  
         22         work        0  
         23        child        0  
         24           br        0  
         25        child        1  
         26          sep        0  
         27    education        1  
         28        child        0  
         29        child        1  
         {\ldots}         {\ldots}      {\ldots}  
         5035       work        0  
         5036       work        1  
         5037       work        0  
         5038       work        1  
         5039       work        1  
         5040       work        1  
         5041       work        1  
         5042       work        0  
         5043       work        0  
         5044       work        0  
         5045       work        1  
         5046       work        0  
         5047       work        1  
         5048       work        0  
         5049       work        0  
         5050       work        0  
         5051       work        0  
         5052       work        0  
         5053       work        1  
         5054       work        0  
         5055       work        0  
         5056       work        0  
         5057       work        1  
         5058       work        0  
         5059       work        1  
         5060       work        0  
         5061       work        0  
         5062       work        1  
         5063       work        0  
         5064       work        1  
         
         [5065 rows x 52 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{education} \PY{n+nb}{type}                       \PY{n+nb}{object}
         \PY{n}{locality}                             \PY{n+nb}{object}
         \PY{n}{religion}                             \PY{n+nb}{object}
         \PY{n}{how\PYZus{}often}                            \PY{n+nb}{object}
         \PY{n}{generation}                           \PY{n+nb}{object}
         \PY{n}{partner}                               \PY{n}{int64}
         \PY{n}{marriage}                              \PY{n}{int64}
         \PY{k}{break}                                 \PY{n}{int64}
         \PY{n}{divorce}                               \PY{n}{int64}
         \PY{n}{child}                                 \PY{n}{int64}
         \PY{n}{sep\PYZus{}from\PYZus{}par}                          \PY{n}{int64}
         \PY{n}{work}                                  \PY{n}{int64}
         \PY{n}{education}                             \PY{n}{int64}
         \PY{n}{partner} \PY{n}{marriage}                     \PY{n+nb}{object}
         \PY{n}{partner} \PY{k}{break}                        \PY{n+nb}{object}
         \PY{n}{partner} \PY{n}{divorce}                      \PY{n+nb}{object}
         \PY{n}{partner} \PY{n}{education}                    \PY{n+nb}{object}
         \PY{n}{partner} \PY{n}{work}                         \PY{n+nb}{object}
         \PY{n}{partner} \PY{n}{separation} \PY{k+kn}{from} \PY{n+nn}{parents}      \PY{n+nb}{object}
         \PY{n}{partner} \PY{n}{child}                        \PY{n+nb}{object}
         \PY{n}{marriage} \PY{k}{break}                       \PY{n+nb}{object}
         \PY{n}{marriage} \PY{n}{divorce}                     \PY{n+nb}{object}
         \PY{n}{marriage} \PY{n}{education}                   \PY{n+nb}{object}
         \PY{n}{marriage} \PY{n}{work}                        \PY{n+nb}{object}
         \PY{n}{marriage} \PY{n}{separation} \PY{k+kn}{from} \PY{n+nn}{parents}     \PY{n+nb}{object}
         \PY{n}{marriage} \PY{n}{child}                       \PY{n+nb}{object}
         \PY{k}{break} \PY{n}{divorce}                        \PY{n+nb}{object}
         \PY{k}{break} \PY{n}{education}                      \PY{n+nb}{object}
         \PY{k}{break} \PY{n}{work}                           \PY{n+nb}{object}
         \PY{k}{break} \PY{n}{separation} \PY{k+kn}{from} \PY{n+nn}{parents}        \PY{n+nb}{object}
         \PY{k}{break} \PY{n}{child}                          \PY{n+nb}{object}
         \PY{n}{divorce} \PY{n}{education}                    \PY{n+nb}{object}
         \PY{n}{divorce} \PY{n}{work}                         \PY{n+nb}{object}
         \PY{n}{divorce} \PY{n}{separation} \PY{k+kn}{from} \PY{n+nn}{parents}      \PY{n+nb}{object}
         \PY{n}{divorce} \PY{n}{child}                        \PY{n+nb}{object}
         \PY{n}{education} \PY{n}{work}                       \PY{n+nb}{object}
         \PY{n}{education} \PY{n}{separation} \PY{k+kn}{from} \PY{n+nn}{parents}    \PY{n+nb}{object}
         \PY{n}{education} \PY{n}{child}                      \PY{n+nb}{object}
         \PY{n}{work} \PY{n}{separation} \PY{k+kn}{from} \PY{n+nn}{parents}         \PY{n+nb}{object}
         \PY{n}{work} \PY{n}{child}                           \PY{n+nb}{object}
         \PY{n}{separation} \PY{k+kn}{from} \PY{n+nn}{parents} \PY{n}{child}        \PY{n+nb}{object}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{LabelEncoder}
         \PY{n}{lb\PYZus{}make} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
         \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{genderLabel}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lb\PYZus{}make}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gender}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education type Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lb\PYZus{}make}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{locality Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lb\PYZus{}make}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{locality}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{religion Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lb\PYZus{}make}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{religion}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{how\PYZus{}often Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lb\PYZus{}make}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{how\PYZus{}often}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{generation Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lb\PYZus{}make}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{generation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{data}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}89}]:}      gender education type locality religion         how\_often generation  \textbackslash{}
         0         f        general     town      yes        sev\_a\_year         9g   
         1         f   professional     town      yes        sev\_a\_year        10g   
         2         f         higher     town      yes        sev\_a\_year         3g   
         3         m   professional     town      yes             never         9g   
         4         f   professional     town      yes  min\_once\_a\_month         3g   
         5         m         higher     town      yes             never         7g   
         6         m        general     town      yes             never         2g   
         7         m         higher     town      yes             never         8g   
         8         f        general     town      yes  min\_once\_a\_month         1g   
         9         m   professional     town      yes             never         8g   
         10        f   professional     town      yes             never         7g   
         11        f   professional     town      yes        sev\_a\_year         6g   
         12        m   professional     town      yes             never         8g   
         13        m   professional     town      yes             never         4g   
         14        f        general     town      yes       once\_a\_week         3g   
         15        f        general     town      yes  min\_once\_a\_month         4g   
         16        f         higher     town      yes        sev\_a\_year         3g   
         17        f        general     town      yes  min\_once\_a\_month         4g   
         18        f   professional     town      yes        sev\_a\_year         2g   
         19        m        general     town      yes             never         8g   
         20        f   professional     town      yes  min\_once\_a\_month         3g   
         21        f   professional     town      yes        sev\_a\_year         5g   
         22        f   professional     town      yes        sev\_a\_year        10g   
         23        f   professional     town      yes  min\_once\_a\_month         7g   
         24        f        general     town      yes        sev\_a\_year         7g   
         25        m        general     town      yes             never         4g   
         26        f         higher     town      yes        sev\_a\_year         6g   
         27        m         higher     town      yes  min\_once\_a\_month         8g   
         28        f        general     town      yes  min\_once\_a\_month         3g   
         29        m   professional     town       no             never         5g   
         {\ldots}     {\ldots}            {\ldots}      {\ldots}      {\ldots}               {\ldots}        {\ldots}   
         5035      f         higher     city      yes        sev\_a\_year         4g   
         5036      m         higher     city      yes             never         7g   
         5037      f         higher     city      yes        sev\_a\_year         5g   
         5038      m   professional     city      yes        sev\_a\_year         2g   
         5039      m   professional     city      yes             never         6g   
         5040      m   professional  village      yes             never         7g   
         5041      m   professional  village       no             never         3g   
         5042      f         higher     city      yes        sev\_a\_year         2g   
         5043      f        general  village      yes             never         6g   
         5044      f        general     city       no             never         3g   
         5045      m         higher     city      yes             never         7g   
         5046      f   professional  village      yes        sev\_a\_year         3g   
         5047      m         higher     town      yes  min\_once\_a\_month        11g   
         5048      f   professional  village      yes             never         6g   
         5049      f         higher  village      yes  min\_once\_a\_month        11g   
         5050      f         higher     city      yes             never        10g   
         5051      f         higher  village      yes        sev\_a\_year         7g   
         5052      f   professional  village       no             never         8g   
         5053      m        general  village      yes             never         2g   
         5054      f        general  village      yes             never         9g   
         5055      f   professional     city      yes        sev\_a\_week         4g   
         5056      f   professional  village      yes             never         5g   
         5057      m   professional  village       no             never        10g   
         5058      f        general     city      yes        sev\_a\_year         7g   
         5059      m   professional     city      yes        sev\_a\_year         9g   
         5060      f   professional     city      yes             never         3g   
         5061      f         higher     city      yes  min\_once\_a\_month         2g   
         5062      m         higher     city       no             never         4g   
         5063      f        general     city      yes        sev\_a\_year         1g   
         5064      m         higher     city       no             never         3g   
         
               partner  marriage  break  divorce        {\ldots}         \textbackslash{}
         0           0         1      0        0        {\ldots}          
         1           0         1      0        0        {\ldots}          
         2           0         1      0        0        {\ldots}          
         3           1         0      0        0        {\ldots}          
         4           0         1      0        0        {\ldots}          
         5           0         1      0        0        {\ldots}          
         6           0         1      0        0        {\ldots}          
         7           1         1      1        0        {\ldots}          
         8           0         1      0        0        {\ldots}          
         9           0         1      0        0        {\ldots}          
         10          0         1      0        0        {\ldots}          
         11          0         1      0        0        {\ldots}          
         12          0         1      0        0        {\ldots}          
         13          0         1      0        0        {\ldots}          
         14          0         0      0        0        {\ldots}          
         15          0         1      0        0        {\ldots}          
         16          0         0      0        0        {\ldots}          
         17          0         0      0        0        {\ldots}          
         18          1         0      0        0        {\ldots}          
         19          0         1      0        0        {\ldots}          
         20          0         1      0        0        {\ldots}          
         21          1         1      0        0        {\ldots}          
         22          0         1      0        0        {\ldots}          
         23          0         1      0        0        {\ldots}          
         24          1         1      0        0        {\ldots}          
         25          0         1      0        0        {\ldots}          
         26          0         1      0        0        {\ldots}          
         27          0         1      0        0        {\ldots}          
         28          0         1      0        0        {\ldots}          
         29          0         1      0        0        {\ldots}          
         {\ldots}       {\ldots}       {\ldots}    {\ldots}      {\ldots}        {\ldots}          
         5035        0         0      0        0        {\ldots}          
         5036        0         1      0        0        {\ldots}          
         5037        1         1      0        0        {\ldots}          
         5038        0         1      0        0        {\ldots}          
         5039        1         0      0        0        {\ldots}          
         5040        0         0      0        0        {\ldots}          
         5041        0         1      0        0        {\ldots}          
         5042        0         1      0        0        {\ldots}          
         5043        1         1      0        0        {\ldots}          
         5044        0         1      0        0        {\ldots}          
         5045        0         1      0        0        {\ldots}          
         5046        0         0      0        0        {\ldots}          
         5047        0         0      0        0        {\ldots}          
         5048        0         0      0        0        {\ldots}          
         5049        0         1      0        0        {\ldots}          
         5050        0         0      0        0        {\ldots}          
         5051        0         1      0        0        {\ldots}          
         5052        0         0      0        0        {\ldots}          
         5053        0         1      0        0        {\ldots}          
         5054        0         1      0        0        {\ldots}          
         5055        0         1      0        0        {\ldots}          
         5056        0         1      0        0        {\ldots}          
         5057        0         0      0        0        {\ldots}          
         5058        1         1      0        0        {\ldots}          
         5059        0         0      0        0        {\ldots}          
         5060        0         1      0        0        {\ldots}          
         5061        0         1      0        1        {\ldots}          
         5062        0         1      0        0        {\ldots}          
         5063        0         1      0        0        {\ldots}          
         5064        0         1      0        0        {\ldots}          
         
               work separation from parents  work child  separation from parents child  \textbackslash{}
         0                                1           1                              0   
         1                                0           0                              0   
         2                                0           0                              0   
         3                                1           0                              0   
         4                                0           0                              0   
         5                                1           0                              0   
         6                                0           0                              0   
         7                                1           0                              0   
         8                                0           0                              0   
         9                                0           0                              0   
         10                               0           0                              1   
         11                               0           0                              1   
         12                               0           0                              0   
         13                               0           0                              1   
         14                               1           1                              0   
         15                               1           0                              0   
         16                               0           0                              0   
         17                               0           0                              0   
         18                               1           0                              0   
         19                               0           0                              0   
         20                               0           0                              1   
         21                               0           0                              1   
         22                               1           1                              0   
         23                               1           0                              0   
         24                               0           0                              0   
         25                               0           0                              0   
         26                               0           0                              1   
         27                               1           1                              0   
         28                               0           0                              0   
         29                               1           0                              0   
         {\ldots}                            {\ldots}         {\ldots}                            {\ldots}   
         5035                             1           1                              1   
         5036                             1           1                              1   
         5037                             1           1                              0   
         5038                             1           1                              0   
         5039                             1           1                              0   
         5040                             1           1                              0   
         5041                             1           1                              0   
         5042                             1           1                              0   
         5043                             1           1                              0   
         5044                             1           1                              0   
         5045                             1           1                              0   
         5046                             1           1                              0   
         5047                             1           1                              1   
         5048                             1           1                              1   
         5049                             1           1                              0   
         5050                             1           1                              0   
         5051                             1           1                              0   
         5052                             1           1                              0   
         5053                             1           1                              0   
         5054                             1           1                              0   
         5055                             1           1                              0   
         5056                             1           1                              0   
         5057                             1           1                              0   
         5058                             1           1                              0   
         5059                             1           1                              1   
         5060                             1           1                              0   
         5061                             1           1                              0   
         5062                             1           1                              0   
         5063                             1           1                              0   
         5064                             1           1                              0   
         
                 last\_ev  genderLabel  education type Label  locality Label  \textbackslash{}
         0          work            0                     0               1   
         1     education            0                     2               1   
         2         child            0                     1               1   
         3            br            1                     2               1   
         4         child            0                     2               1   
         5         child            1                     1               1   
         6         child            1                     0               1   
         7           div            1                     1               1   
         8         child            0                     0               1   
         9         child            1                     2               1   
         10          sep            0                     2               1   
         11          sep            0                     2               1   
         12        child            1                     2               1   
         13          sep            1                     2               1   
         14         work            0                     0               1   
         15        child            0                     0               1   
         16    education            0                     1               1   
         17        child            0                     0               1   
         18     marriage            0                     2               1   
         19        child            1                     0               1   
         20          sep            0                     2               1   
         21          div            0                     2               1   
         22         work            0                     2               1   
         23        child            0                     2               1   
         24           br            0                     0               1   
         25        child            1                     0               1   
         26          sep            0                     1               1   
         27    education            1                     1               1   
         28        child            0                     0               1   
         29        child            1                     2               1   
         {\ldots}         {\ldots}          {\ldots}                   {\ldots}             {\ldots}   
         5035       work            0                     1               0   
         5036       work            1                     1               0   
         5037       work            0                     1               0   
         5038       work            1                     2               0   
         5039       work            1                     2               0   
         5040       work            1                     2               2   
         5041       work            1                     2               2   
         5042       work            0                     1               0   
         5043       work            0                     0               2   
         5044       work            0                     0               0   
         5045       work            1                     1               0   
         5046       work            0                     2               2   
         5047       work            1                     1               1   
         5048       work            0                     2               2   
         5049       work            0                     1               2   
         5050       work            0                     1               0   
         5051       work            0                     1               2   
         5052       work            0                     2               2   
         5053       work            1                     0               2   
         5054       work            0                     0               2   
         5055       work            0                     2               0   
         5056       work            0                     2               2   
         5057       work            1                     2               2   
         5058       work            0                     0               0   
         5059       work            1                     2               0   
         5060       work            0                     2               0   
         5061       work            0                     1               0   
         5062       work            1                     1               0   
         5063       work            0                     0               0   
         5064       work            1                     1               0   
         
               religion Label  how\_often Label  generation Label  
         0                  1                4                10  
         1                  1                4                 0  
         2                  1                4                 4  
         3                  1                1                10  
         4                  1                0                 4  
         5                  1                1                 8  
         6                  1                1                 3  
         7                  1                1                 9  
         8                  1                0                 2  
         9                  1                1                 9  
         10                 1                1                 8  
         11                 1                4                 7  
         12                 1                1                 9  
         13                 1                1                 5  
         14                 1                2                 4  
         15                 1                0                 5  
         16                 1                4                 4  
         17                 1                0                 5  
         18                 1                4                 3  
         19                 1                1                 9  
         20                 1                0                 4  
         21                 1                4                 6  
         22                 1                4                 0  
         23                 1                0                 8  
         24                 1                4                 8  
         25                 1                1                 5  
         26                 1                4                 7  
         27                 1                0                 9  
         28                 1                0                 4  
         29                 0                1                 6  
         {\ldots}              {\ldots}              {\ldots}               {\ldots}  
         5035               1                4                 5  
         5036               1                1                 8  
         5037               1                4                 6  
         5038               1                4                 3  
         5039               1                1                 7  
         5040               1                1                 8  
         5041               0                1                 4  
         5042               1                4                 3  
         5043               1                1                 7  
         5044               0                1                 4  
         5045               1                1                 8  
         5046               1                4                 4  
         5047               1                0                 1  
         5048               1                1                 7  
         5049               1                0                 1  
         5050               1                1                 0  
         5051               1                4                 8  
         5052               0                1                 9  
         5053               1                1                 3  
         5054               1                1                10  
         5055               1                3                 5  
         5056               1                1                 6  
         5057               0                1                 0  
         5058               1                4                 8  
         5059               1                4                10  
         5060               1                1                 4  
         5061               1                0                 3  
         5062               0                1                 5  
         5063               1                4                 2  
         5064               0                1                 4  
         
         [5065 rows x 57 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{n}{cleanup\PYZus{}nums} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner marriage}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner break}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}        
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner divorce}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}          
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner education}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}              
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner work}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}                      
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner separation from parents}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage break}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage divorce}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set} \PY{p}{,}
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage education}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}               
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage work}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage separation from parents}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}  
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break divorce}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}  
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break education}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break work}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}       
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break separation from parents}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,} 
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,}                       
         \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce education}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{clean\PYZus{}set}\PY{p}{,} 
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce work}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}                         
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce separation from parents}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,} 
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education work}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set} \PY{p}{,}          
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education separation from parents}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}    
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}                      
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work separation from parents}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}         
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}\PY{p}{,}            
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{separation from parents child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{clean\PYZus{}set}
                        \PY{p}{\PYZcb{}}
         
         \PY{n}{data}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{cleanup\PYZus{}nums}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}87}]:}   gender education type locality religion         how\_often generation  \textbackslash{}
         0      f        general     town      yes        sev\_a\_year         9g   
         1      f   professional     town      yes        sev\_a\_year        10g   
         2      f         higher     town      yes        sev\_a\_year         3g   
         3      m   professional     town      yes             never         9g   
         4      f   professional     town      yes  min\_once\_a\_month         3g   
         
            partner  marriage  break  divorce    {\ldots}      divorce work  \textbackslash{}
         0        0         1      0        0    {\ldots}                 1   
         1        0         1      0        0    {\ldots}                 1   
         2        0         1      0        0    {\ldots}                 1   
         3        1         0      0        0    {\ldots}                 1   
         4        0         1      0        0    {\ldots}                 1   
         
            divorce separation from parents  divorce child  education work  \textbackslash{}
         0                                1              1               0   
         1                                1              1               1   
         2                                1              1               1   
         3                                1              1               0   
         4                                1              1               0   
         
            education separation from parents  education child  \textbackslash{}
         0                                  1                0   
         1                                  1                1   
         2                                  1                0   
         3                                  0                0   
         4                                  0                0   
         
            work separation from parents  work child  separation from parents child  \textbackslash{}
         0                             1           1                              0   
         1                             0           0                              0   
         2                             0           0                              0   
         3                             1           0                              0   
         4                             0           0                              0   
         
              last\_ev  
         0       work  
         1  education  
         2      child  
         3         br  
         4      child  
         
         [5 rows x 51 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{partner.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{marriage.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{break.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{divorce.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{child.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sep\PYZus{}from\PYZus{}par.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gender}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{education type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{locality}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{religion}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{how\PYZus{}often}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{generation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{data}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}90}]:}       partner  marriage  break  divorce  child  sep\_from\_par  work  education  \textbackslash{}
         0           0         1      0        0      1             1     0          1   
         1           0         1      0        0      1             1     1          0   
         2           0         1      0        0      0             1     1          1   
         3           1         0      0        0      1             1     1          1   
         4           0         1      0        0      0             1     1          1   
         5           0         1      0        0      0             1     1          1   
         6           0         1      0        0      0             1     1          1   
         7           1         1      1        0      1             1     1          1   
         8           0         1      0        0      0             1     1          1   
         9           0         1      0        0      0             1     1          1   
         10          0         1      0        0      1             0     1          1   
         11          0         1      0        0      1             0     1          1   
         12          0         1      0        0      0             1     1          1   
         13          0         1      0        0      1             0     1          1   
         14          0         0      0        0      1             1     0          1   
         15          0         1      0        0      0             1     1          1   
         16          0         0      0        0      1             1     1          0   
         17          0         0      0        0      0             1     1          1   
         18          1         0      0        0      1             1     1          1   
         19          0         1      0        0      0             1     1          1   
         20          0         1      0        0      1             0     1          1   
         21          1         1      0        0      1             1     1          1   
         22          0         1      0        0      1             1     0          1   
         23          0         1      0        0      0             1     1          1   
         24          1         1      0        0      1             1     1          1   
         25          0         1      0        0      0             1     1          1   
         26          0         1      0        0      1             0     1          1   
         27          0         1      0        0      1             1     1          0   
         28          0         1      0        0      0             1     1          1   
         29          0         1      0        0      0             1     1          1   
         {\ldots}       {\ldots}       {\ldots}    {\ldots}      {\ldots}    {\ldots}           {\ldots}   {\ldots}        {\ldots}   
         5035        0         0      0        0      0             0     0          1   
         5036        0         1      0        0      1             0     0          1   
         5037        1         1      0        0      1             1     0          0   
         5038        0         1      0        0      1             1     0          0   
         5039        1         0      0        0      1             1     0          0   
         5040        0         0      0        0      0             1     0          0   
         5041        0         1      0        0      1             1     0          0   
         5042        0         1      0        0      0             1     0          0   
         5043        1         1      0        0      1             1     0          0   
         5044        0         1      0        0      1             1     0          0   
         5045        0         1      0        0      1             1     0          0   
         5046        0         0      0        0      0             1     0          0   
         5047        0         0      0        0      0             0     0          0   
         5048        0         0      0        0      0             0     0          0   
         5049        0         1      0        0      1             1     0          0   
         5050        0         0      0        0      0             1     0          0   
         5051        0         1      0        0      1             1     0          0   
         5052        0         0      0        0      0             1     0          0   
         5053        0         1      0        0      1             1     0          0   
         5054        0         1      0        0      1             1     0          0   
         5055        0         1      0        0      1             1     0          0   
         5056        0         1      0        0      1             1     0          0   
         5057        0         0      0        0      0             1     0          0   
         5058        1         1      0        0      1             1     0          0   
         5059        0         0      0        0      0             0     0          0   
         5060        0         1      0        0      1             1     0          0   
         5061        0         1      0        1      1             1     0          0   
         5062        0         1      0        0      1             1     0          0   
         5063        0         1      0        0      1             1     0          0   
         5064        0         1      0        0      1             1     0          0   
         
               partner marriage  partner break        {\ldots}         \textbackslash{}
         0                    1              1        {\ldots}          
         1                    1              1        {\ldots}          
         2                    1              1        {\ldots}          
         3                    0              0        {\ldots}          
         4                    1              1        {\ldots}          
         5                    1              1        {\ldots}          
         6                    1              1        {\ldots}          
         7                    0              0        {\ldots}          
         8                    1              1        {\ldots}          
         9                    1              1        {\ldots}          
         10                   1              1        {\ldots}          
         11                   1              1        {\ldots}          
         12                   1              1        {\ldots}          
         13                   1              1        {\ldots}          
         14                   1              1        {\ldots}          
         15                   1              1        {\ldots}          
         16                   1              1        {\ldots}          
         17                   1              1        {\ldots}          
         18                   0              0        {\ldots}          
         19                   1              1        {\ldots}          
         20                   1              1        {\ldots}          
         21                   1              0        {\ldots}          
         22                   1              1        {\ldots}          
         23                   1              1        {\ldots}          
         24                   1              0        {\ldots}          
         25                   1              1        {\ldots}          
         26                   1              1        {\ldots}          
         27                   1              1        {\ldots}          
         28                   1              1        {\ldots}          
         29                   1              1        {\ldots}          
         {\ldots}                {\ldots}            {\ldots}        {\ldots}          
         5035                 1              1        {\ldots}          
         5036                 1              1        {\ldots}          
         5037                 0              0        {\ldots}          
         5038                 1              1        {\ldots}          
         5039                 0              0        {\ldots}          
         5040                 1              1        {\ldots}          
         5041                 1              1        {\ldots}          
         5042                 1              1        {\ldots}          
         5043                 0              0        {\ldots}          
         5044                 1              1        {\ldots}          
         5045                 1              1        {\ldots}          
         5046                 1              1        {\ldots}          
         5047                 1              1        {\ldots}          
         5048                 1              1        {\ldots}          
         5049                 1              1        {\ldots}          
         5050                 1              1        {\ldots}          
         5051                 1              1        {\ldots}          
         5052                 1              1        {\ldots}          
         5053                 1              1        {\ldots}          
         5054                 1              1        {\ldots}          
         5055                 1              1        {\ldots}          
         5056                 1              1        {\ldots}          
         5057                 1              1        {\ldots}          
         5058                 0              0        {\ldots}          
         5059                 1              1        {\ldots}          
         5060                 1              1        {\ldots}          
         5061                 1              1        {\ldots}          
         5062                 1              1        {\ldots}          
         5063                 1              1        {\ldots}          
         5064                 1              1        {\ldots}          
         
               work separation from parents  work child  separation from parents child  \textbackslash{}
         0                                1           1                              0   
         1                                0           0                              0   
         2                                0           0                              0   
         3                                1           0                              0   
         4                                0           0                              0   
         5                                1           0                              0   
         6                                0           0                              0   
         7                                1           0                              0   
         8                                0           0                              0   
         9                                0           0                              0   
         10                               0           0                              1   
         11                               0           0                              1   
         12                               0           0                              0   
         13                               0           0                              1   
         14                               1           1                              0   
         15                               1           0                              0   
         16                               0           0                              0   
         17                               0           0                              0   
         18                               1           0                              0   
         19                               0           0                              0   
         20                               0           0                              1   
         21                               0           0                              1   
         22                               1           1                              0   
         23                               1           0                              0   
         24                               0           0                              0   
         25                               0           0                              0   
         26                               0           0                              1   
         27                               1           1                              0   
         28                               0           0                              0   
         29                               1           0                              0   
         {\ldots}                            {\ldots}         {\ldots}                            {\ldots}   
         5035                             1           1                              1   
         5036                             1           1                              1   
         5037                             1           1                              0   
         5038                             1           1                              0   
         5039                             1           1                              0   
         5040                             1           1                              0   
         5041                             1           1                              0   
         5042                             1           1                              0   
         5043                             1           1                              0   
         5044                             1           1                              0   
         5045                             1           1                              0   
         5046                             1           1                              0   
         5047                             1           1                              1   
         5048                             1           1                              1   
         5049                             1           1                              0   
         5050                             1           1                              0   
         5051                             1           1                              0   
         5052                             1           1                              0   
         5053                             1           1                              0   
         5054                             1           1                              0   
         5055                             1           1                              0   
         5056                             1           1                              0   
         5057                             1           1                              0   
         5058                             1           1                              0   
         5059                             1           1                              1   
         5060                             1           1                              0   
         5061                             1           1                              0   
         5062                             1           1                              0   
         5063                             1           1                              0   
         5064                             1           1                              0   
         
                 last\_ev  genderLabel  education type Label  locality Label  \textbackslash{}
         0          work            0                     0               1   
         1     education            0                     2               1   
         2         child            0                     1               1   
         3            br            1                     2               1   
         4         child            0                     2               1   
         5         child            1                     1               1   
         6         child            1                     0               1   
         7           div            1                     1               1   
         8         child            0                     0               1   
         9         child            1                     2               1   
         10          sep            0                     2               1   
         11          sep            0                     2               1   
         12        child            1                     2               1   
         13          sep            1                     2               1   
         14         work            0                     0               1   
         15        child            0                     0               1   
         16    education            0                     1               1   
         17        child            0                     0               1   
         18     marriage            0                     2               1   
         19        child            1                     0               1   
         20          sep            0                     2               1   
         21          div            0                     2               1   
         22         work            0                     2               1   
         23        child            0                     2               1   
         24           br            0                     0               1   
         25        child            1                     0               1   
         26          sep            0                     1               1   
         27    education            1                     1               1   
         28        child            0                     0               1   
         29        child            1                     2               1   
         {\ldots}         {\ldots}          {\ldots}                   {\ldots}             {\ldots}   
         5035       work            0                     1               0   
         5036       work            1                     1               0   
         5037       work            0                     1               0   
         5038       work            1                     2               0   
         5039       work            1                     2               0   
         5040       work            1                     2               2   
         5041       work            1                     2               2   
         5042       work            0                     1               0   
         5043       work            0                     0               2   
         5044       work            0                     0               0   
         5045       work            1                     1               0   
         5046       work            0                     2               2   
         5047       work            1                     1               1   
         5048       work            0                     2               2   
         5049       work            0                     1               2   
         5050       work            0                     1               0   
         5051       work            0                     1               2   
         5052       work            0                     2               2   
         5053       work            1                     0               2   
         5054       work            0                     0               2   
         5055       work            0                     2               0   
         5056       work            0                     2               2   
         5057       work            1                     2               2   
         5058       work            0                     0               0   
         5059       work            1                     2               0   
         5060       work            0                     2               0   
         5061       work            0                     1               0   
         5062       work            1                     1               0   
         5063       work            0                     0               0   
         5064       work            1                     1               0   
         
               religion Label  how\_often Label  generation Label  
         0                  1                4                10  
         1                  1                4                 0  
         2                  1                4                 4  
         3                  1                1                10  
         4                  1                0                 4  
         5                  1                1                 8  
         6                  1                1                 3  
         7                  1                1                 9  
         8                  1                0                 2  
         9                  1                1                 9  
         10                 1                1                 8  
         11                 1                4                 7  
         12                 1                1                 9  
         13                 1                1                 5  
         14                 1                2                 4  
         15                 1                0                 5  
         16                 1                4                 4  
         17                 1                0                 5  
         18                 1                4                 3  
         19                 1                1                 9  
         20                 1                0                 4  
         21                 1                4                 6  
         22                 1                4                 0  
         23                 1                0                 8  
         24                 1                4                 8  
         25                 1                1                 5  
         26                 1                4                 7  
         27                 1                0                 9  
         28                 1                0                 4  
         29                 0                1                 6  
         {\ldots}              {\ldots}              {\ldots}               {\ldots}  
         5035               1                4                 5  
         5036               1                1                 8  
         5037               1                4                 6  
         5038               1                4                 3  
         5039               1                1                 7  
         5040               1                1                 8  
         5041               0                1                 4  
         5042               1                4                 3  
         5043               1                1                 7  
         5044               0                1                 4  
         5045               1                1                 8  
         5046               1                4                 4  
         5047               1                0                 1  
         5048               1                1                 7  
         5049               1                0                 1  
         5050               1                1                 0  
         5051               1                4                 8  
         5052               0                1                 9  
         5053               1                1                 3  
         5054               1                1                10  
         5055               1                3                 5  
         5056               1                1                 6  
         5057               0                1                 0  
         5058               1                4                 8  
         5059               1                4                10  
         5060               1                1                 4  
         5061               1                0                 3  
         5062               0                1                 5  
         5063               1                4                 2  
         5064               0                1                 4  
         
         [5065 rows x 43 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{n}{data}\PY{o}{.}\PY{n}{dtypes}\PY{p}{,}\PY{n}{data}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}91}]:} (partner                               int64
          marriage                              int64
          break                                 int64
          divorce                               int64
          child                                 int64
          sep\_from\_par                          int64
          work                                  int64
          education                             int64
          partner marriage                      int64
          partner break                         int64
          partner divorce                       int64
          partner education                     int64
          partner work                          int64
          partner separation from parents       int64
          partner child                         int64
          marriage break                        int64
          marriage divorce                      int64
          marriage education                    int64
          marriage work                         int64
          marriage separation from parents      int64
          marriage child                        int64
          break divorce                         int64
          break education                       int64
          break work                            int64
          break separation from parents         int64
          break child                           int64
          divorce education                     int64
          divorce work                          int64
          divorce separation from parents       int64
          divorce child                         int64
          education work                        int64
          education separation from parents     int64
          education child                       int64
          work separation from parents          int64
          work child                            int64
          separation from parents child         int64
          last\_ev                              object
          genderLabel                           int64
          education type Label                  int64
          locality Label                        int64
          religion Label                        int64
          how\_often Label                       int64
          generation Label                      int64
          dtype: object, False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{X\PYZus{}observation} \PY{o}{=} \PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}observation}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}92}]:}      gender education type locality religion how\_often generation  partner  \textbackslash{}
         1952      f        general  village      yes     never         3g        0   
         
               marriage  break  divorce              {\ldots}               \textbackslash{}
         1952         1      0        0              {\ldots}                
         
               divorce education  divorce work  divorce separation from parents  \textbackslash{}
         1952                  >             >                                >   
         
               divorce child education work education separation from parents  \textbackslash{}
         1952              n              <                                 <   
         
              education child work separation from parents work child  \textbackslash{}
         1952               <                            >          <   
         
              separation from parents child  
         1952                             <  
         
         [1 rows x 42 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{l+s+se}{\PYZbs{}}
         \PY{l+s+s2}{* True label: }\PY{l+s+si}{\PYZob{}y\PYZus{}test.iloc[i]\PYZcb{}}
         \PY{l+s+s2}{* LR: }\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{lr\PYZus{}model.predict\PYZus{}proba(X\PYZus{}observation)[0]\PYZcb{}}
         \PY{l+s+s2}{* DT: }\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{dt\PYZus{}model.predict\PYZus{}proba(X\PYZus{}observation)[0]\PYZcb{}}
         \PY{l+s+s2}{* RF: }\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{rf\PYZus{}model.predict\PYZus{}proba(X\PYZus{}observation)[0]\PYZcb{}}
         \PY{l+s+s2}{* XGB: }\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{xgb\PYZus{}model.predict\PYZus{}proba(X\PYZus{}observation)[0]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
* True label: 0
* LR: [9.84819575e-01 1.42692377e-06 1.44389674e-05 3.72651506e-04
 8.71960837e-03 3.83239477e-06 1.50644951e-05 6.05340221e-03]
* DT: [0.92404351 0.         0.         0.01323987 0.05501947 0.
 0.         0.00769715]
* RF: [9.57401066e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 4.20436718e-02 0.00000000e+00 0.00000000e+00 5.55262646e-04]
* XGB: [0.87187505 0.0171143  0.01713007 0.01737295 0.0243275  0.01711863
 0.01715922 0.01790235]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{k+kn}{import} \PY{n+nn}{shap}
         \PY{c+c1}{\PYZsh{} Need to load JS vis in the notebook}
         \PY{n}{shap}\PY{o}{.}\PY{n}{initjs}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}98}]:} \PY{n}{X} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{last\PYZus{}ev}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{stratify}\PY{o}{=}\PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{n}{explainer} \PY{o}{=} \PY{n}{shap}\PY{o}{.}\PY{n}{TreeExplainer}\PY{p}{(}\PY{n}{xgb\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}101}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{summary\PYZus{}plot}\PY{p}{(}\PY{n}{shap\PYZus{}values}\PY{p}{,} \PY{n}{features}\PY{o}{=}\PY{n}{observations}\PY{p}{,} \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{all\PYZus{}features}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{CourseWork_final_files/CourseWork_final_64_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{force\PYZus{}plot}\PY{p}{(}\PY{n}{explainer}\PY{o}{.}\PY{n}{expected\PYZus{}value}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{shap\PYZus{}values}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{link}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{logit}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}102}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}103}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{summary\PYZus{}plot}\PY{p}{(}\PY{n}{shap\PYZus{}values}\PY{p}{,} \PY{n}{features}\PY{o}{=}\PY{n}{observations}\PY{p}{,} \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{all\PYZus{}features}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{CourseWork_final_files/CourseWork_final_66_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{k+kn}{import} \PY{n+nn}{numpy}
          \PY{k+kn}{import} \PY{n+nn}{pandas}
          \PY{k+kn}{import} \PY{n+nn}{random}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}\PY{p}{,} \PY{n}{Dropout}\PY{p}{,} \PY{n}{Activation}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{wrappers}\PY{n+nn}{.}\PY{n+nn}{scikit\PYZus{}learn} \PY{k}{import} \PY{n}{KerasClassifier}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{utils} \PY{k}{import} \PY{n}{np\PYZus{}utils}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}score}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{KFold}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{LabelEncoder}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{Pipeline}
          \PY{n}{encoder} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
          \PY{n}{encoder}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{y}\PY{p}{)}
          \PY{n}{encoded\PYZus{}Y} \PY{o}{=} \PY{n}{encoder}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{y}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} convert integers to dummy variables (i.e. one hot encoded)}
          \PY{n}{dummy\PYZus{}y} \PY{o}{=} \PY{n}{np\PYZus{}utils}\PY{o}{.}\PY{n}{to\PYZus{}categorical}\PY{p}{(}\PY{n}{encoded\PYZus{}Y}\PY{p}{)}
          
          \PY{k}{def} \PY{n+nf}{baseline\PYZus{}model}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{c+c1}{\PYZsh{} create model}
              \PY{n}{model} \PY{o}{=} \PY{n}{Sequential}\PY{p}{(}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{input\PYZus{}dim}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.25}\PY{p}{)}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{150}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.25}\PY{p}{)}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.25}\PY{p}{)}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
              \PY{c+c1}{\PYZsh{} Compile model}
              \PY{n}{model}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{categorical\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{optimizer}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{metrics}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{k}{return} \PY{n}{model}
          
          
          \PY{n}{estimator} \PY{o}{=} \PY{n}{KerasClassifier}\PY{p}{(}\PY{n}{build\PYZus{}fn}\PY{o}{=}\PY{n}{baseline\PYZus{}model}\PY{p}{,} \PY{n}{epochs}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
          \PY{n}{kfold} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}\PY{p}{)}
          \PY{n}{results} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{estimator}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{dummy\PYZus{}y}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{kfold}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Baseline: }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{results}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{results}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
WARNING:tensorflow:From /anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/math\_ops.py:3066: to\_int32 (from tensorflow.python.ops.math\_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
Baseline: 84.60\% (1.02\%)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}108}]:} \PY{n}{explainer} \PY{o}{=} \PY{n}{shap}\PY{o}{.}\PY{n}{TreeExplainer}\PY{p}{(}\PY{n}{xgb\PYZus{}model}\PY{o}{.}\PY{n}{named\PYZus{}steps}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{summary\PYZus{}plot}\PY{p}{(}\PY{n}{shap\PYZus{}values}\PY{p}{,} \PY{n}{features}\PY{o}{=}\PY{n}{observations}\PY{p}{,} \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{all\PYZus{}features}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{CourseWork_final_files/CourseWork_final_69_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}110}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{force\PYZus{}plot}\PY{p}{(}\PY{n}{explainer}\PY{o}{.}\PY{n}{expected\PYZus{}value}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{shap\PYZus{}values}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{link}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{logit}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}110}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}111}]:} \PY{k+kn}{import} \PY{n+nn}{xgboost}
          \PY{k+kn}{import} \PY{n+nn}{shap}
          
          \PY{c+c1}{\PYZsh{} load JS visualization code to notebook}
          \PY{n}{shap}\PY{o}{.}\PY{n}{initjs}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} train XGBoost model}
          \PY{n}{model} \PY{o}{=} \PY{n}{xgboost}\PY{o}{.}\PY{n}{train}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{learning\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+m+mf}{0.01}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{xgboost}\PY{o}{.}\PY{n}{DMatrix}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{y}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} explain the model\PYZsq{}s predictions using SHAP values}
          \PY{c+c1}{\PYZsh{} (same syntax works for LightGBM, CatBoost, and scikit\PYZhy{}learn models)}
          \PY{n}{explainer} \PY{o}{=} \PY{n}{shap}\PY{o}{.}\PY{n}{TreeExplainer}\PY{p}{(}\PY{n}{model}\PY{p}{)}
          \PY{n}{shap\PYZus{}values} \PY{o}{=} \PY{n}{explainer}\PY{o}{.}\PY{n}{shap\PYZus{}values}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} visualize the first prediction\PYZsq{}s explanation (use matplotlib=True to avoid Javascript)}
          \PY{n}{shap}\PY{o}{.}\PY{n}{force\PYZus{}plot}\PY{p}{(}\PY{n}{explainer}\PY{o}{.}\PY{n}{expected\PYZus{}value}\PY{p}{,} \PY{n}{shap\PYZus{}values}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
/anaconda3/lib/python3.7/site-packages/xgboost/core.py:587: FutureWarning: Series.base is deprecated and will be removed in a future version
  if getattr(data, 'base', None) is not None and \textbackslash{}

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}111}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{force\PYZus{}plot}\PY{p}{(}\PY{n}{explainer}\PY{o}{.}\PY{n}{expected\PYZus{}value}\PY{p}{,} \PY{n}{shap\PYZus{}values}\PY{p}{,} \PY{n}{X}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/anaconda3/lib/python3.7/site-packages/shap/plots/force.py:111: UserWarning: shap.force\_plot is slow many thousands of rows, try subsampling your data.
  warnings.warn("shap.force\_plot is slow many thousands of rows, try subsampling your data.")

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}112}]:} <IPython.core.display.HTML object>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{dependence\PYZus{}plot}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{child}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{shap\PYZus{}values}\PY{p}{,} \PY{n}{X}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{CourseWork_final_files/CourseWork_final_73_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{summary\PYZus{}plot}\PY{p}{(}\PY{n}{shap\PYZus{}values}\PY{p}{,} \PY{n}{X}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{CourseWork_final_files/CourseWork_final_74_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}116}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{summary\PYZus{}plot}\PY{p}{(}\PY{n}{shap\PYZus{}values}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{plot\PYZus{}type}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bar}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{CourseWork_final_files/CourseWork_final_75_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{n}{shap}\PY{o}{.}\PY{n}{TreeExplainer}\PY{p}{(}\PY{n}{model}\PY{p}{)}\PY{o}{.}\PY{n}{shap\PYZus{}interaction\PYZus{}values}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}119}]:} array([[[ 2.14727521e-01, -1.57544017e-03,  5.36835054e-03, {\ldots},
                    0.00000000e+00, -2.13955063e-05,  1.13390386e-04],
                  [-1.57544762e-03, -2.03365639e-01,  8.69623153e-04, {\ldots},
                   -1.78825372e-04,  3.01279128e-04, -5.70882112e-04],
                  [ 5.36835194e-03,  8.69676471e-04, -9.72912274e-03, {\ldots},
                    0.00000000e+00,  8.66688788e-06,  0.00000000e+00],
                  {\ldots},
                  [ 0.00000000e+00, -1.78843737e-04,  0.00000000e+00, {\ldots},
                    4.16739786e-04,  7.71600753e-07,  3.05557624e-05],
                  [-2.14427710e-05,  3.01279128e-04,  8.66758637e-06, {\ldots},
                    7.71848136e-07,  7.10603409e-03,  8.63093883e-05],
                  [ 1.13353133e-04, -5.70930541e-04,  0.00000000e+00, {\ldots},
                    3.05558060e-05,  8.63103196e-05, -2.37835944e-02]],
          
                 [[ 2.15447187e-01,  4.67509776e-03,  2.13851850e-03, {\ldots},
                    0.00000000e+00,  2.16361295e-05, -1.66764163e-04],
                  [ 4.67511639e-03, -1.79479167e-01,  2.58908956e-04, {\ldots},
                   -8.13835504e-05,  3.46008572e-04,  1.49085058e-03],
                  [ 2.13854015e-03,  2.58937478e-04, -8.22188146e-03, {\ldots},
                    0.00000000e+00,  8.40979374e-06,  0.00000000e+00],
                  {\ldots},
                  [ 0.00000000e+00, -8.13826919e-05,  0.00000000e+00, {\ldots},
                    3.16048943e-04,  5.12853148e-07, -4.79098271e-05],
                  [ 2.16290355e-05,  3.46042216e-04,  8.41030851e-06, {\ldots},
                    5.12860424e-07, -9.26897483e-05, -4.18533928e-05],
                  [-1.66766346e-04,  1.49079785e-03,  0.00000000e+00, {\ldots},
                   -4.79099072e-05, -4.18533746e-05, -1.10720680e-03]],
          
                 [[ 2.00508043e-01,  4.02889401e-03,  1.86046213e-03, {\ldots},
                    0.00000000e+00,  1.15294606e-04, -4.61601536e-04],
                  [ 4.02906165e-03, -2.06135258e-01, -7.52988504e-04, {\ldots},
                   -9.93885042e-05,  1.94154750e-03, -7.37442926e-04],
                  [ 1.86045468e-03, -7.52992928e-04, -7.02854013e-03, {\ldots},
                    0.00000000e+00,  1.95416505e-05,  0.00000000e+00],
                  {\ldots},
                  [ 0.00000000e+00, -9.93907452e-05,  0.00000000e+00, {\ldots},
                    3.08913091e-04,  4.68106009e-07,  1.94801833e-05],
                  [ 1.15282834e-04,  1.94157660e-03,  1.95414759e-05, {\ldots},
                    4.68120561e-07, -6.54972973e-04, -8.72066594e-05],
                  [-4.61608171e-04, -7.37398863e-04,  0.00000000e+00, {\ldots},
                    1.94801323e-05, -8.72066303e-05,  2.88029481e-03]],
          
                 {\ldots},
          
                 [[ 1.74092188e-01,  1.72683969e-03,  2.13851873e-03, {\ldots},
                    0.00000000e+00, -1.76168396e-05, -2.02110037e-04],
                  [ 1.72683224e-03, -1.77184761e-01,  3.39410617e-04, {\ldots},
                    3.47911147e-04,  5.64802322e-04, -1.53645873e-04],
                  [ 2.13854760e-03,  3.39426100e-04, -7.69741414e-03, {\ldots},
                    0.00000000e+00,  8.33830563e-06,  0.00000000e+00],
                  {\ldots},
                  [ 0.00000000e+00,  3.47919762e-04,  0.00000000e+00, {\ldots},
                   -1.06788916e-03, -1.70950079e-06, -7.02813268e-05],
                  [-1.76355243e-05,  5.64768910e-04,  8.33871309e-06, {\ldots},
                   -1.70951535e-06, -2.49694195e-03, -2.64234841e-05],
                  [-2.02137977e-04, -1.53671950e-04,  0.00000000e+00, {\ldots},
                   -7.02855759e-05, -2.64227274e-05, -2.40117237e-02]],
          
                 [[ 1.75840348e-01,  1.37460977e-03,  2.13851873e-03, {\ldots},
                    0.00000000e+00,  8.47782940e-06, -1.30909495e-04],
                  [ 1.37460977e-03, -1.84429452e-01,  3.48696834e-04, {\ldots},
                   -7.27988372e-05,  3.35414428e-04,  1.39076356e-03],
                  [ 2.13855505e-03,  3.48690897e-04, -7.70884752e-03, {\ldots},
                    0.00000000e+00,  7.92683568e-06,  0.00000000e+00],
                  {\ldots},
                  [ 0.00000000e+00, -7.27809966e-05,  0.00000000e+00, {\ldots},
                    3.13661119e-04,  5.12693077e-07, -4.79677692e-05],
                  [ 8.46385956e-06,  3.35406512e-04,  7.92753417e-06, {\ldots},
                    5.12853148e-07,  2.71450216e-03, -2.54949555e-05],
                  [-1.30932778e-04,  1.39068812e-03,  0.00000000e+00, {\ldots},
                   -4.79689552e-05, -2.54947226e-05, -9.81625728e-03]],
          
                 [[ 1.74092188e-01,  1.72683969e-03,  2.13851873e-03, {\ldots},
                    0.00000000e+00, -1.76168396e-05, -2.02110037e-04],
                  [ 1.72683224e-03, -1.77184761e-01,  3.39410617e-04, {\ldots},
                    3.47911147e-04,  5.64802322e-04, -1.53645873e-04],
                  [ 2.13854760e-03,  3.39426100e-04, -7.69741414e-03, {\ldots},
                    0.00000000e+00,  8.33830563e-06,  0.00000000e+00],
                  {\ldots},
                  [ 0.00000000e+00,  3.47919762e-04,  0.00000000e+00, {\ldots},
                   -1.06788916e-03, -1.70950079e-06, -7.02813268e-05],
                  [-1.76355243e-05,  5.64768910e-04,  8.33871309e-06, {\ldots},
                   -1.70951535e-06, -2.49694195e-03, -2.64234841e-05],
                  [-2.02137977e-04, -1.53671950e-04,  0.00000000e+00, {\ldots},
                   -7.02855759e-05, -2.64227274e-05, -2.40117237e-02]]],
                dtype=float32)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k}{import} \PY{n}{print\PYZus{}function}
          
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{sequence}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}\PY{p}{,} \PY{n}{Embedding}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{LSTM}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k}{import} \PY{n}{imdb}
          
          \PY{n}{max\PYZus{}features} \PY{o}{=} \PY{l+m+mi}{20000}
          \PY{n}{maxlen} \PY{o}{=} \PY{l+m+mi}{100}  \PY{c+c1}{\PYZsh{} cut texts after this number of words (among top max\PYZus{}features most common words)}
          \PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{l+m+mi}{32}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loading data...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train sequences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test sequences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} print(\PYZsq{}Pad sequences (samples x time)\PYZsq{})}
          \PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{sequence}\PY{o}{.}\PY{n}{pad\PYZus{}sequences}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{maxlen}\PY{o}{=}\PY{n}{maxlen}\PY{p}{)}
          \PY{n}{x\PYZus{}test} \PY{o}{=} \PY{n}{sequence}\PY{o}{.}\PY{n}{pad\PYZus{}sequences}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{maxlen}\PY{o}{=}\PY{n}{maxlen}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} print(\PYZsq{}x\PYZus{}train shape:\PYZsq{}, x\PYZus{}train.shape)}
          \PY{c+c1}{\PYZsh{} print(\PYZsq{}x\PYZus{}test shape:\PYZsq{}, x\PYZus{}test.shape)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Build model...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{model} \PY{o}{=} \PY{n}{Sequential}\PY{p}{(}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{input\PYZus{}dim}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.25}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{150}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.25}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.25}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} try using different optimizers and different optimizer configs}
          \PY{n}{model}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{optimizer}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{metrics}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,}
                    \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batch\PYZus{}size}\PY{p}{,}
                    \PY{n}{epochs}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}
                    \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n}{score}\PY{p}{,} \PY{n}{acc} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,}
                                      \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batch\PYZus{}size}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test accuracy:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{acc}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Loading data{\ldots}
4052 train sequences
1013 test sequences

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        ValueError                                Traceback (most recent call last)

        <ipython-input-125-6b1e507fd505> in <module>
         16 
         17 \# print('Pad sequences (samples x time)')
    ---> 18 x\_train = sequence.pad\_sequences(x\_train, maxlen=maxlen)
         19 x\_test = sequence.pad\_sequences(x\_test, maxlen=maxlen)
         20 \# print('x\_train shape:', x\_train.shape)


        /anaconda3/lib/python3.7/site-packages/keras\_preprocessing/sequence.py in pad\_sequences(sequences, maxlen, dtype, padding, truncating, value)
         92 
         93         \# check `trunc` has expected shape
    ---> 94         trunc = np.asarray(trunc, dtype=dtype)
         95         if trunc.shape[1:] != sample\_shape:
         96             raise ValueError('Shape of sample \%s of sequence at position \%s '


        /anaconda3/lib/python3.7/site-packages/numpy/core/numeric.py in asarray(a, dtype, order)
        499 
        500     """
    --> 501     return array(a, dtype, copy=False, order=order)
        502 
        503 


        ValueError: invalid literal for int() with base 10: 'partner'

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{x\PYZus{}train}\PY{p}{,}\PY{n}{x\PYZus{}test}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}124}]:} (      partner  marriage  break  divorce  child  sep\_from\_par  work  education  \textbackslash{}
           4993        0         0      0        0      0             0     1          1   
           142         0         1      0        0      1             1     1          1   
           1191        1         1      0        0      1             1     0          1   
           1563        0         1      0        0      1             1     1          1   
           72          1         1      0        0      1             1     1          0   
           39          0         1      0        0      1             1     1          0   
           3732        1         1      0        0      1             0     1          1   
           2670        0         0      0        0      1             0     1          1   
           534         0         1      0        0      0             1     1          1   
           3628        0         1      0        0      0             1     1          1   
           2709        1         1      1        1      1             0     1          1   
           4949        0         1      0        0      0             1     1          0   
           2879        0         1      0        0      0             1     1          1   
           2807        0         1      0        0      0             1     1          1   
           4894        1         1      0        0      1             1     1          1   
           1399        0         1      0        0      1             0     1          1   
           3162        0         0      0        0      0             0     1          1   
           1223        0         1      0        0      0             1     1          1   
           2193        0         1      0        0      1             1     0          1   
           4986        0         0      0        0      1             1     1          0   
           533         0         1      0        1      1             1     1          1   
           4976        1         0      0        0      0             1     1          1   
           1670        0         1      0        0      0             1     1          1   
           898         0         1      0        1      1             1     1          1   
           2804        0         1      0        0      0             1     1          1   
           148         0         0      0        0      1             0     1          1   
           302         0         1      0        0      1             0     1          1   
           1853        0         0      0        0      0             0     1          1   
           265         0         1      0        0      0             1     1          1   
           1958        0         1      0        0      0             1     1          1   
           {\ldots}       {\ldots}       {\ldots}    {\ldots}      {\ldots}    {\ldots}           {\ldots}   {\ldots}        {\ldots}   
           4129        0         0      0        0      0             1     1          1   
           4704        0         1      0        0      1             1     1          0   
           3589        0         1      0        0      0             1     1          1   
           1330        1         0      0        0      1             1     1          1   
           195         1         1      0        0      1             1     1          1   
           514         0         1      0        0      0             1     1          1   
           2052        0         1      0        0      0             1     1          1   
           3920        1         1      1        1      1             0     1          1   
           2374        0         1      0        0      0             1     1          1   
           1974        0         1      0        0      0             1     1          1   
           3844        1         0      0        0      1             1     1          1   
           2799        0         0      0        0      0             1     1          1   
           406         0         1      0        0      0             1     1          1   
           1888        0         1      0        0      1             0     0          1   
           32          1         1      0        0      0             1     1          1   
           1961        0         1      0        0      1             1     0          1   
           854         1         1      0        1      1             1     1          1   
           4271        1         1      0        1      0             1     1          1   
           4355        0         0      0        0      0             1     1          1   
           1519        0         0      0        0      0             1     1          1   
           2527        0         1      0        1      1             1     1          0   
           4834        0         0      0        0      0             1     1          1   
           2164        1         1      1        0      0             1     1          1   
           3647        0         0      0        0      1             1     1          0   
           1014        1         1      0        0      0             1     1          1   
           630         0         1      0        0      0             1     1          1   
           2701        0         1      0        0      1             0     1          1   
           4140        1         0      0        0      0             1     1          1   
           2315        1         1      0        1      1             1     1          1   
           4172        1         1      0        0      1             0     1          1   
           
                 partner marriage  partner break        {\ldots}         education child  \textbackslash{}
           4993                 1              1        {\ldots}                       0   
           142                  1              1        {\ldots}                       0   
           1191                 0              0        {\ldots}                       1   
           1563                 1              1        {\ldots}                       0   
           72                   0              0        {\ldots}                       1   
           39                   1              1        {\ldots}                       1   
           3732                 0              0        {\ldots}                       0   
           2670                 1              1        {\ldots}                       1   
           534                  1              1        {\ldots}                       0   
           3628                 1              1        {\ldots}                       0   
           2709                 0              0        {\ldots}                       0   
           4949                 1              1        {\ldots}                       1   
           2879                 1              1        {\ldots}                       0   
           2807                 1              1        {\ldots}                       0   
           4894                 0              0        {\ldots}                       0   
           1399                 1              1        {\ldots}                       0   
           3162                 1              1        {\ldots}                       0   
           1223                 1              1        {\ldots}                       0   
           2193                 1              1        {\ldots}                       0   
           4986                 1              1        {\ldots}                       1   
           533                  1              1        {\ldots}                       0   
           4976                 0              0        {\ldots}                       0   
           1670                 1              1        {\ldots}                       0   
           898                  1              1        {\ldots}                       1   
           2804                 1              1        {\ldots}                       0   
           148                  1              1        {\ldots}                       1   
           302                  1              1        {\ldots}                       1   
           1853                 1              1        {\ldots}                       0   
           265                  1              1        {\ldots}                       0   
           1958                 1              1        {\ldots}                       0   
           {\ldots}                {\ldots}            {\ldots}        {\ldots}                     {\ldots}   
           4129                 1              1        {\ldots}                       0   
           4704                 1              1        {\ldots}                       1   
           3589                 1              1        {\ldots}                       0   
           1330                 0              0        {\ldots}                       1   
           195                  0              0        {\ldots}                       1   
           514                  1              1        {\ldots}                       0   
           2052                 1              1        {\ldots}                       0   
           3920                 0              0        {\ldots}                       0   
           2374                 1              1        {\ldots}                       0   
           1974                 1              1        {\ldots}                       0   
           3844                 0              0        {\ldots}                       0   
           2799                 1              1        {\ldots}                       0   
           406                  1              1        {\ldots}                       0   
           1888                 1              1        {\ldots}                       0   
           32                   0              0        {\ldots}                       0   
           1961                 1              1        {\ldots}                       0   
           854                  1              0        {\ldots}                       1   
           4271                 1              0        {\ldots}                       0   
           4355                 1              1        {\ldots}                       0   
           1519                 1              1        {\ldots}                       0   
           2527                 1              1        {\ldots}                       1   
           4834                 1              1        {\ldots}                       0   
           2164                 0              0        {\ldots}                       0   
           3647                 1              1        {\ldots}                       1   
           1014                 0              0        {\ldots}                       0   
           630                  1              1        {\ldots}                       0   
           2701                 1              1        {\ldots}                       1   
           4140                 0              0        {\ldots}                       0   
           2315                 1              0        {\ldots}                       0   
           4172                 0              0        {\ldots}                       0   
           
                 work separation from parents  work child  separation from parents child  \textbackslash{}
           4993                             0           0                              1   
           142                              0           0                              0   
           1191                             1           1                              0   
           1563                             0           0                              0   
           72                               1           1                              0   
           39                               0           0                              0   
           3732                             0           0                              1   
           2670                             0           0                              1   
           534                              0           0                              0   
           3628                             0           0                              0   
           2709                             0           0                              1   
           4949                             0           0                              0   
           2879                             0           0                              0   
           2807                             1           0                              0   
           4894                             0           0                              0   
           1399                             0           0                              1   
           3162                             0           0                              1   
           1223                             0           0                              0   
           2193                             1           1                              0   
           4986                             1           0                              0   
           533                              0           0                              0   
           4976                             1           0                              0   
           1670                             0           0                              0   
           898                              1           1                              0   
           2804                             1           0                              0   
           148                              0           0                              1   
           302                              0           0                              1   
           1853                             0           0                              1   
           265                              1           0                              0   
           1958                             0           0                              0   
           {\ldots}                            {\ldots}         {\ldots}                            {\ldots}   
           4129                             0           0                              0   
           4704                             1           0                              0   
           3589                             1           0                              0   
           1330                             1           0                              0   
           195                              1           1                              0   
           514                              0           0                              0   
           2052                             1           0                              0   
           3920                             0           0                              1   
           2374                             1           0                              0   
           1974                             0           0                              0   
           3844                             0           0                              0   
           2799                             1           0                              0   
           406                              1           0                              0   
           1888                             1           1                              1   
           32                               0           0                              0   
           1961                             1           1                              0   
           854                              0           0                              0   
           4271                             0           0                              0   
           4355                             0           0                              0   
           1519                             0           0                              0   
           2527                             0           0                              0   
           4834                             1           0                              0   
           2164                             1           0                              0   
           3647                             0           0                              0   
           1014                             0           0                              0   
           630                              0           0                              0   
           2701                             0           1                              1   
           4140                             0           0                              0   
           2315                             0           0                              0   
           4172                             0           0                              1   
           
                 genderLabel  education type Label  locality Label  religion Label  \textbackslash{}
           4993            0                     0               2               1   
           142             1                     2               2               1   
           1191            1                     1               0               1   
           1563            0                     2               0               1   
           72              1                     2               2               1   
           39              1                     2               1               1   
           3732            0                     2               2               1   
           2670            0                     2               0               0   
           534             1                     2               2               1   
           3628            0                     2               0               1   
           2709            1                     2               0               1   
           4949            0                     0               2               1   
           2879            0                     2               2               1   
           2807            1                     2               0               1   
           4894            1                     0               2               0   
           1399            0                     2               2               1   
           3162            1                     2               2               0   
           1223            0                     1               0               1   
           2193            0                     0               0               1   
           4986            1                     1               2               1   
           533             0                     0               2               1   
           4976            0                     0               2               0   
           1670            0                     0               1               1   
           898             0                     2               0               1   
           2804            0                     2               0               1   
           148             0                     2               2               1   
           302             1                     2               0               1   
           1853            1                     1               1               1   
           265             0                     2               0               0   
           1958            1                     0               2               1   
           {\ldots}           {\ldots}                   {\ldots}             {\ldots}             {\ldots}   
           4129            1                     1               0               1   
           4704            0                     1               0               1   
           3589            0                     2               0               1   
           1330            0                     2               0               1   
           195             0                     0               0               1   
           514             1                     0               2               1   
           2052            0                     2               0               1   
           3920            0                     2               0               1   
           2374            1                     0               2               1   
           1974            0                     0               2               1   
           3844            1                     2               0               0   
           2799            0                     0               0               1   
           406             0                     2               0               1   
           1888            0                     0               2               1   
           32              1                     1               1               1   
           1961            0                     0               2               1   
           854             0                     0               0               0   
           4271            0                     1               0               1   
           4355            0                     0               0               1   
           1519            0                     0               2               1   
           2527            0                     2               2               1   
           4834            0                     1               0               1   
           2164            1                     2               0               1   
           3647            0                     1               1               1   
           1014            0                     0               2               1   
           630             0                     2               2               0   
           2701            0                     1               0               1   
           4140            1                     0               0               1   
           2315            0                     2               2               1   
           4172            1                     2               0               1   
           
                 how\_often Label  generation Label  
           4993                1                 3  
           142                 1                 5  
           1191                4                 9  
           1563                0                 8  
           72                  1                 2  
           39                  1                 6  
           3732                4                 8  
           2670                1                 6  
           534                 1                 7  
           3628                4                 2  
           2709                1                 0  
           4949                1                 5  
           2879                1                 8  
           2807                1                 6  
           4894                1                10  
           1399                4                10  
           3162                1                 6  
           1223                4                 7  
           2193                4                 8  
           4986                0                 9  
           533                 1                 5  
           4976                1                 1  
           1670                4                 4  
           898                 1                 6  
           2804                4                 5  
           148                 4                 2  
           302                 4                 6  
           1853                0                 1  
           265                 1                 7  
           1958                2                 8  
           {\ldots}               {\ldots}               {\ldots}  
           4129                1                10  
           4704                4                 5  
           3589                1                 2  
           1330                4                 7  
           195                 4                 3  
           514                 4                 7  
           2052                4                 5  
           3920                1                 5  
           2374                1                 8  
           1974                1                 8  
           3844                1                 7  
           2799                4                 5  
           406                 4                 6  
           1888                0                 9  
           32                  1                 3  
           1961                4                 4  
           854                 1                 4  
           4271                4                 7  
           4355                1                 8  
           1519                1                 5  
           2527                1                 7  
           4834                4                 9  
           2164                1                 7  
           3647                1                 4  
           1014                1                 6  
           630                 1                 8  
           2701                4                 8  
           4140                1                 7  
           2315                1                 4  
           4172                1                 0  
           
           [1013 rows x 42 columns], 4993    6
           142     7
           1191    5
           1563    4
           72      1
           39      1
           3732    2
           2670    2
           534     0
           3628    0
           2709    2
           4949    0
           2879    0
           2807    0
           4894    4
           1399    2
           3162    2
           1223    0
           2193    5
           4986    1
           533     7
           4976    6
           1670    0
           898     7
           2804    0
           148     2
           302     2
           1853    6
           265     0
           1958    0
                  ..
           4129    6
           4704    1
           3589    0
           1330    6
           195     3
           514     0
           2052    0
           3920    2
           2374    0
           1974    0
           3844    6
           2799    7
           406     0
           1888    2
           32      0
           1961    5
           854     3
           4271    0
           4355    0
           1519    0
           2527    1
           4834    6
           2164    4
           3647    1
           1014    0
           630     0
           2701    2
           4140    6
           2315    3
           4172    2
           Name: last\_ev, Length: 1013, dtype: int64,       partner  marriage  break  divorce  child  sep\_from\_par  work  education  \textbackslash{}
           3848        0         1      0        0      0             1     1          1   
           1523        0         1      0        0      0             1     1          1   
           521         0         0      0        0      0             1     1          1   
           1189        0         1      0        0      1             1     1          0   
           4377        0         1      0        0      0             1     1          1   
           1960        0         0      0        0      0             1     0          1   
           3048        1         1      0        1      1             1     1          1   
           378         1         0      0        0      0             1     1          1   
           829         0         1      0        0      0             1     1          1   
           1108        0         1      0        0      0             1     1          1   
           2196        1         1      0        0      0             1     1          1   
           3558        0         1      0        0      1             1     1          0   
           2484        1         1      0        0      0             1     1          1   
           4082        0         1      0        1      1             1     1          1   
           1290        1         1      0        0      1             0     1          1   
           3385        0         1      0        0      0             1     1          1   
           1765        1         0      0        0      0             1     1          1   
           2409        1         1      1        0      1             1     1          1   
           4553        0         1      0        0      1             0     1          1   
           4706        0         1      0        0      0             1     1          1   
           720         0         0      0        0      1             0     1          1   
           938         1         1      0        0      0             1     1          1   
           122         0         1      0        0      0             1     1          1   
           4582        1         1      0        0      0             1     1          1   
           161         0         1      0        0      0             1     1          1   
           1432        0         0      0        0      1             0     1          1   
           545         1         1      0        1      1             1     1          1   
           4727        0         0      0        0      0             0     1          1   
           263         0         1      0        0      0             1     1          1   
           4599        1         0      0        0      0             1     1          1   
           {\ldots}       {\ldots}       {\ldots}    {\ldots}      {\ldots}    {\ldots}           {\ldots}   {\ldots}        {\ldots}   
           3337        0         1      0        0      1             1     0          1   
           423         1         1      0        0      1             1     1          1   
           3219        0         1      0        0      1             0     1          1   
           659         0         1      0        0      1             0     1          1   
           797         1         1      0        0      1             1     1          1   
           755         0         1      0        1      1             1     1          1   
           2008        1         0      0        0      1             1     1          1   
           99          0         0      0        0      0             1     1          1   
           2496        0         0      0        0      1             1     1          1   
           1871        0         1      0        0      0             1     1          1   
           2046        0         1      0        0      0             1     1          1   
           4851        1         1      0        0      0             1     1          1   
           2163        0         1      0        1      1             1     1          1   
           2893        0         1      0        0      0             1     1          1   
           537         0         1      0        0      0             1     1          1   
           1701        0         1      0        0      0             1     1          1   
           2897        1         1      0        0      1             1     1          0   
           2222        1         1      1        1      1             1     1          0   
           2135        0         1      0        0      0             1     1          1   
           2599        0         1      0        0      1             0     1          1   
           705         0         1      0        0      1             0     1          1   
           3468        0         1      0        1      0             1     1          1   
           4373        0         1      0        0      0             1     1          1   
           1033        1         1      0        0      0             1     1          1   
           4859        1         1      0        0      1             1     1          1   
           4931        1         1      0        0      1             1     1          1   
           3264        1         1      0        0      1             1     1          1   
           1653        0         1      0        0      1             1     1          0   
           2607        0         1      0        0      1             1     1          0   
           2732        0         1      0        0      0             1     1          1   
           
                 partner marriage  partner break        {\ldots}         education child  \textbackslash{}
           3848                 1              1        {\ldots}                       0   
           1523                 1              1        {\ldots}                       0   
           521                  1              1        {\ldots}                       0   
           1189                 1              1        {\ldots}                       1   
           4377                 1              1        {\ldots}                       0   
           1960                 1              1        {\ldots}                       0   
           3048                 1              0        {\ldots}                       0   
           378                  0              0        {\ldots}                       0   
           829                  1              1        {\ldots}                       0   
           1108                 1              1        {\ldots}                       0   
           2196                 0              0        {\ldots}                       0   
           3558                 1              1        {\ldots}                       1   
           2484                 0              0        {\ldots}                       0   
           4082                 1              1        {\ldots}                       0   
           1290                 0              0        {\ldots}                       1   
           3385                 1              1        {\ldots}                       0   
           1765                 0              0        {\ldots}                       0   
           2409                 0              0        {\ldots}                       0   
           4553                 1              1        {\ldots}                       0   
           4706                 1              1        {\ldots}                       0   
           720                  1              1        {\ldots}                       0   
           938                  0              0        {\ldots}                       0   
           122                  1              1        {\ldots}                       0   
           4582                 0              0        {\ldots}                       0   
           161                  1              1        {\ldots}                       0   
           1432                 1              1        {\ldots}                       0   
           545                  1              0        {\ldots}                       0   
           4727                 1              1        {\ldots}                       0   
           263                  1              1        {\ldots}                       0   
           4599                 0              0        {\ldots}                       0   
           {\ldots}                {\ldots}            {\ldots}        {\ldots}                     {\ldots}   
           3337                 1              1        {\ldots}                       0   
           423                  0              0        {\ldots}                       0   
           3219                 1              1        {\ldots}                       0   
           659                  1              1        {\ldots}                       0   
           797                  0              0        {\ldots}                       0   
           755                  1              1        {\ldots}                       1   
           2008                 0              0        {\ldots}                       0   
           99                   1              1        {\ldots}                       0   
           2496                 1              1        {\ldots}                       0   
           1871                 1              1        {\ldots}                       0   
           2046                 1              1        {\ldots}                       0   
           4851                 0              0        {\ldots}                       0   
           2163                 1              1        {\ldots}                       0   
           2893                 1              1        {\ldots}                       0   
           537                  1              1        {\ldots}                       0   
           1701                 1              1        {\ldots}                       0   
           2897                 0              0        {\ldots}                       1   
           2222                 1              0        {\ldots}                       1   
           2135                 1              1        {\ldots}                       0   
           2599                 1              1        {\ldots}                       0   
           705                  1              1        {\ldots}                       1   
           3468                 1              1        {\ldots}                       0   
           4373                 1              1        {\ldots}                       0   
           1033                 0              0        {\ldots}                       0   
           4859                 0              0        {\ldots}                       0   
           4931                 0              0        {\ldots}                       0   
           3264                 0              0        {\ldots}                       1   
           1653                 1              1        {\ldots}                       1   
           2607                 1              1        {\ldots}                       1   
           2732                 1              1        {\ldots}                       0   
           
                 work separation from parents  work child  separation from parents child  \textbackslash{}
           3848                             0           0                              0   
           1523                             1           0                              0   
           521                              0           0                              0   
           1189                             0           0                              0   
           4377                             0           0                              0   
           1960                             1           1                              0   
           3048                             0           0                              0   
           378                              1           0                              0   
           829                              0           0                              0   
           1108                             1           0                              0   
           2196                             0           0                              0   
           3558                             1           0                              0   
           2484                             0           0                              0   
           4082                             0           0                              0   
           1290                             0           1                              1   
           3385                             0           0                              0   
           1765                             0           0                              0   
           2409                             0           0                              0   
           4553                             0           0                              1   
           4706                             1           0                              0   
           720                              0           0                              1   
           938                              0           0                              0   
           122                              1           0                              0   
           4582                             0           0                              0   
           161                              0           0                              0   
           1432                             0           0                              1   
           545                              0           0                              0   
           4727                             0           0                              1   
           263                              0           0                              0   
           4599                             0           0                              0   
           {\ldots}                            {\ldots}         {\ldots}                            {\ldots}   
           3337                             1           1                              0   
           423                              1           0                              0   
           3219                             0           0                              1   
           659                              0           0                              1   
           797                              1           0                              0   
           755                              1           1                              0   
           2008                             0           0                              0   
           99                               0           0                              0   
           2496                             0           0                              0   
           1871                             1           0                              0   
           2046                             0           0                              0   
           4851                             0           0                              0   
           2163                             1           1                              0   
           2893                             0           0                              0   
           537                              1           0                              0   
           1701                             1           0                              0   
           2897                             1           1                              0   
           2222                             0           0                              0   
           2135                             0           0                              0   
           2599                             0           0                              1   
           705                              0           1                              1   
           3468                             1           0                              0   
           4373                             0           0                              0   
           1033                             1           0                              0   
           4859                             0           0                              1   
           4931                             0           0                              0   
           3264                             0           0                              0   
           1653                             0           0                              0   
           2607                             0           0                              0   
           2732                             0           0                              0   
           
                 genderLabel  education type Label  locality Label  religion Label  \textbackslash{}
           3848            0                     2               0               1   
           1523            0                     1               2               1   
           521             0                     2               2               1   
           1189            0                     0               0               1   
           4377            0                     0               0               1   
           1960            1                     0               2               1   
           3048            0                     2               0               1   
           378             0                     1               0               1   
           829             1                     1               0               1   
           1108            1                     1               0               1   
           2196            1                     1               0               1   
           3558            0                     1               2               1   
           2484            1                     0               2               1   
           4082            0                     2               0               1   
           1290            0                     2               0               1   
           3385            1                     2               1               1   
           1765            0                     2               2               1   
           2409            0                     0               2               0   
           4553            1                     2               0               1   
           4706            1                     1               0               0   
           720             0                     0               2               1   
           938             0                     2               0               1   
           122             0                     2               2               1   
           4582            1                     0               0               0   
           161             1                     2               2               1   
           1432            0                     0               2               1   
           545             0                     0               2               1   
           4727            0                     2               0               1   
           263             0                     1               0               1   
           4599            0                     0               0               1   
           {\ldots}           {\ldots}                   {\ldots}             {\ldots}             {\ldots}   
           3337            0                     2               0               1   
           423             0                     0               0               0   
           3219            0                     1               0               1   
           659             1                     0               2               0   
           797             0                     2               2               1   
           755             1                     2               2               1   
           2008            0                     2               0               1   
           99              0                     0               2               1   
           2496            1                     2               2               0   
           1871            0                     1               1               1   
           2046            0                     0               0               1   
           4851            1                     2               0               1   
           2163            1                     2               0               0   
           2893            0                     0               2               1   
           537             0                     2               2               0   
           1701            1                     1               1               1   
           2897            0                     2               2               1   
           2222            0                     2               0               1   
           2135            0                     0               0               1   
           2599            0                     2               2               1   
           705             0                     2               2               1   
           3468            1                     0               0               1   
           4373            0                     2               0               1   
           1033            0                     2               0               1   
           4859            1                     2               0               1   
           4931            1                     2               0               1   
           3264            0                     1               0               0   
           1653            0                     2               1               1   
           2607            1                     1               2               1   
           2732            1                     0               0               1   
           
                 how\_often Label  generation Label  
           3848                4                 9  
           1523                1                 8  
           521                 1                 5  
           1189                2                 3  
           4377                1                 6  
           1960                1                 9  
           3048                4                10  
           378                 4                 7  
           829                 1                 2  
           1108                4                 7  
           2196                4                 6  
           3558                4                 7  
           2484                4                 7  
           4082                0                 9  
           1290                4                10  
           3385                1                 6  
           1765                4                 9  
           2409                1                 9  
           4553                4                 9  
           4706                1                 3  
           720                 1                 3  
           938                 1                10  
           122                 1                 7  
           4582                1                 4  
           161                 1                 7  
           1432                1                 2  
           545                 1                 8  
           4727                1                 0  
           263                 4                 7  
           4599                4                 7  
           {\ldots}               {\ldots}               {\ldots}  
           3337                1                 3  
           423                 1                 8  
           3219                4                 3  
           659                 1                 5  
           797                 1                 7  
           755                 1                 4  
           2008                4                 1  
           99                  4                 3  
           2496                1                 7  
           1871                1                 5  
           2046                4                 8  
           4851                1                10  
           2163                1                 5  
           2893                4                 4  
           537                 1                 8  
           1701                1                 2  
           2897                4                 6  
           2222                4                 4  
           2135                1                 2  
           2599                4                10  
           705                 4                10  
           3468                4                 2  
           4373                1                 9  
           1033                4                 9  
           4859                1                 7  
           4931                0                 5  
           3264                1                 4  
           1653                2                 3  
           2607                1                 3  
           2732                1                 2  
           
           [4052 rows x 42 columns],       partner  marriage  break  divorce  child  sep\_from\_par  work  education  \textbackslash{}
           4993        0         0      0        0      0             0     1          1   
           142         0         1      0        0      1             1     1          1   
           1191        1         1      0        0      1             1     0          1   
           1563        0         1      0        0      1             1     1          1   
           72          1         1      0        0      1             1     1          0   
           39          0         1      0        0      1             1     1          0   
           3732        1         1      0        0      1             0     1          1   
           2670        0         0      0        0      1             0     1          1   
           534         0         1      0        0      0             1     1          1   
           3628        0         1      0        0      0             1     1          1   
           2709        1         1      1        1      1             0     1          1   
           4949        0         1      0        0      0             1     1          0   
           2879        0         1      0        0      0             1     1          1   
           2807        0         1      0        0      0             1     1          1   
           4894        1         1      0        0      1             1     1          1   
           1399        0         1      0        0      1             0     1          1   
           3162        0         0      0        0      0             0     1          1   
           1223        0         1      0        0      0             1     1          1   
           2193        0         1      0        0      1             1     0          1   
           4986        0         0      0        0      1             1     1          0   
           533         0         1      0        1      1             1     1          1   
           4976        1         0      0        0      0             1     1          1   
           1670        0         1      0        0      0             1     1          1   
           898         0         1      0        1      1             1     1          1   
           2804        0         1      0        0      0             1     1          1   
           148         0         0      0        0      1             0     1          1   
           302         0         1      0        0      1             0     1          1   
           1853        0         0      0        0      0             0     1          1   
           265         0         1      0        0      0             1     1          1   
           1958        0         1      0        0      0             1     1          1   
           {\ldots}       {\ldots}       {\ldots}    {\ldots}      {\ldots}    {\ldots}           {\ldots}   {\ldots}        {\ldots}   
           4129        0         0      0        0      0             1     1          1   
           4704        0         1      0        0      1             1     1          0   
           3589        0         1      0        0      0             1     1          1   
           1330        1         0      0        0      1             1     1          1   
           195         1         1      0        0      1             1     1          1   
           514         0         1      0        0      0             1     1          1   
           2052        0         1      0        0      0             1     1          1   
           3920        1         1      1        1      1             0     1          1   
           2374        0         1      0        0      0             1     1          1   
           1974        0         1      0        0      0             1     1          1   
           3844        1         0      0        0      1             1     1          1   
           2799        0         0      0        0      0             1     1          1   
           406         0         1      0        0      0             1     1          1   
           1888        0         1      0        0      1             0     0          1   
           32          1         1      0        0      0             1     1          1   
           1961        0         1      0        0      1             1     0          1   
           854         1         1      0        1      1             1     1          1   
           4271        1         1      0        1      0             1     1          1   
           4355        0         0      0        0      0             1     1          1   
           1519        0         0      0        0      0             1     1          1   
           2527        0         1      0        1      1             1     1          0   
           4834        0         0      0        0      0             1     1          1   
           2164        1         1      1        0      0             1     1          1   
           3647        0         0      0        0      1             1     1          0   
           1014        1         1      0        0      0             1     1          1   
           630         0         1      0        0      0             1     1          1   
           2701        0         1      0        0      1             0     1          1   
           4140        1         0      0        0      0             1     1          1   
           2315        1         1      0        1      1             1     1          1   
           4172        1         1      0        0      1             0     1          1   
           
                 partner marriage  partner break        {\ldots}         education child  \textbackslash{}
           4993                 1              1        {\ldots}                       0   
           142                  1              1        {\ldots}                       0   
           1191                 0              0        {\ldots}                       1   
           1563                 1              1        {\ldots}                       0   
           72                   0              0        {\ldots}                       1   
           39                   1              1        {\ldots}                       1   
           3732                 0              0        {\ldots}                       0   
           2670                 1              1        {\ldots}                       1   
           534                  1              1        {\ldots}                       0   
           3628                 1              1        {\ldots}                       0   
           2709                 0              0        {\ldots}                       0   
           4949                 1              1        {\ldots}                       1   
           2879                 1              1        {\ldots}                       0   
           2807                 1              1        {\ldots}                       0   
           4894                 0              0        {\ldots}                       0   
           1399                 1              1        {\ldots}                       0   
           3162                 1              1        {\ldots}                       0   
           1223                 1              1        {\ldots}                       0   
           2193                 1              1        {\ldots}                       0   
           4986                 1              1        {\ldots}                       1   
           533                  1              1        {\ldots}                       0   
           4976                 0              0        {\ldots}                       0   
           1670                 1              1        {\ldots}                       0   
           898                  1              1        {\ldots}                       1   
           2804                 1              1        {\ldots}                       0   
           148                  1              1        {\ldots}                       1   
           302                  1              1        {\ldots}                       1   
           1853                 1              1        {\ldots}                       0   
           265                  1              1        {\ldots}                       0   
           1958                 1              1        {\ldots}                       0   
           {\ldots}                {\ldots}            {\ldots}        {\ldots}                     {\ldots}   
           4129                 1              1        {\ldots}                       0   
           4704                 1              1        {\ldots}                       1   
           3589                 1              1        {\ldots}                       0   
           1330                 0              0        {\ldots}                       1   
           195                  0              0        {\ldots}                       1   
           514                  1              1        {\ldots}                       0   
           2052                 1              1        {\ldots}                       0   
           3920                 0              0        {\ldots}                       0   
           2374                 1              1        {\ldots}                       0   
           1974                 1              1        {\ldots}                       0   
           3844                 0              0        {\ldots}                       0   
           2799                 1              1        {\ldots}                       0   
           406                  1              1        {\ldots}                       0   
           1888                 1              1        {\ldots}                       0   
           32                   0              0        {\ldots}                       0   
           1961                 1              1        {\ldots}                       0   
           854                  1              0        {\ldots}                       1   
           4271                 1              0        {\ldots}                       0   
           4355                 1              1        {\ldots}                       0   
           1519                 1              1        {\ldots}                       0   
           2527                 1              1        {\ldots}                       1   
           4834                 1              1        {\ldots}                       0   
           2164                 0              0        {\ldots}                       0   
           3647                 1              1        {\ldots}                       1   
           1014                 0              0        {\ldots}                       0   
           630                  1              1        {\ldots}                       0   
           2701                 1              1        {\ldots}                       1   
           4140                 0              0        {\ldots}                       0   
           2315                 1              0        {\ldots}                       0   
           4172                 0              0        {\ldots}                       0   
           
                 work separation from parents  work child  separation from parents child  \textbackslash{}
           4993                             0           0                              1   
           142                              0           0                              0   
           1191                             1           1                              0   
           1563                             0           0                              0   
           72                               1           1                              0   
           39                               0           0                              0   
           3732                             0           0                              1   
           2670                             0           0                              1   
           534                              0           0                              0   
           3628                             0           0                              0   
           2709                             0           0                              1   
           4949                             0           0                              0   
           2879                             0           0                              0   
           2807                             1           0                              0   
           4894                             0           0                              0   
           1399                             0           0                              1   
           3162                             0           0                              1   
           1223                             0           0                              0   
           2193                             1           1                              0   
           4986                             1           0                              0   
           533                              0           0                              0   
           4976                             1           0                              0   
           1670                             0           0                              0   
           898                              1           1                              0   
           2804                             1           0                              0   
           148                              0           0                              1   
           302                              0           0                              1   
           1853                             0           0                              1   
           265                              1           0                              0   
           1958                             0           0                              0   
           {\ldots}                            {\ldots}         {\ldots}                            {\ldots}   
           4129                             0           0                              0   
           4704                             1           0                              0   
           3589                             1           0                              0   
           1330                             1           0                              0   
           195                              1           1                              0   
           514                              0           0                              0   
           2052                             1           0                              0   
           3920                             0           0                              1   
           2374                             1           0                              0   
           1974                             0           0                              0   
           3844                             0           0                              0   
           2799                             1           0                              0   
           406                              1           0                              0   
           1888                             1           1                              1   
           32                               0           0                              0   
           1961                             1           1                              0   
           854                              0           0                              0   
           4271                             0           0                              0   
           4355                             0           0                              0   
           1519                             0           0                              0   
           2527                             0           0                              0   
           4834                             1           0                              0   
           2164                             1           0                              0   
           3647                             0           0                              0   
           1014                             0           0                              0   
           630                              0           0                              0   
           2701                             0           1                              1   
           4140                             0           0                              0   
           2315                             0           0                              0   
           4172                             0           0                              1   
           
                 genderLabel  education type Label  locality Label  religion Label  \textbackslash{}
           4993            0                     0               2               1   
           142             1                     2               2               1   
           1191            1                     1               0               1   
           1563            0                     2               0               1   
           72              1                     2               2               1   
           39              1                     2               1               1   
           3732            0                     2               2               1   
           2670            0                     2               0               0   
           534             1                     2               2               1   
           3628            0                     2               0               1   
           2709            1                     2               0               1   
           4949            0                     0               2               1   
           2879            0                     2               2               1   
           2807            1                     2               0               1   
           4894            1                     0               2               0   
           1399            0                     2               2               1   
           3162            1                     2               2               0   
           1223            0                     1               0               1   
           2193            0                     0               0               1   
           4986            1                     1               2               1   
           533             0                     0               2               1   
           4976            0                     0               2               0   
           1670            0                     0               1               1   
           898             0                     2               0               1   
           2804            0                     2               0               1   
           148             0                     2               2               1   
           302             1                     2               0               1   
           1853            1                     1               1               1   
           265             0                     2               0               0   
           1958            1                     0               2               1   
           {\ldots}           {\ldots}                   {\ldots}             {\ldots}             {\ldots}   
           4129            1                     1               0               1   
           4704            0                     1               0               1   
           3589            0                     2               0               1   
           1330            0                     2               0               1   
           195             0                     0               0               1   
           514             1                     0               2               1   
           2052            0                     2               0               1   
           3920            0                     2               0               1   
           2374            1                     0               2               1   
           1974            0                     0               2               1   
           3844            1                     2               0               0   
           2799            0                     0               0               1   
           406             0                     2               0               1   
           1888            0                     0               2               1   
           32              1                     1               1               1   
           1961            0                     0               2               1   
           854             0                     0               0               0   
           4271            0                     1               0               1   
           4355            0                     0               0               1   
           1519            0                     0               2               1   
           2527            0                     2               2               1   
           4834            0                     1               0               1   
           2164            1                     2               0               1   
           3647            0                     1               1               1   
           1014            0                     0               2               1   
           630             0                     2               2               0   
           2701            0                     1               0               1   
           4140            1                     0               0               1   
           2315            0                     2               2               1   
           4172            1                     2               0               1   
           
                 how\_often Label  generation Label  
           4993                1                 3  
           142                 1                 5  
           1191                4                 9  
           1563                0                 8  
           72                  1                 2  
           39                  1                 6  
           3732                4                 8  
           2670                1                 6  
           534                 1                 7  
           3628                4                 2  
           2709                1                 0  
           4949                1                 5  
           2879                1                 8  
           2807                1                 6  
           4894                1                10  
           1399                4                10  
           3162                1                 6  
           1223                4                 7  
           2193                4                 8  
           4986                0                 9  
           533                 1                 5  
           4976                1                 1  
           1670                4                 4  
           898                 1                 6  
           2804                4                 5  
           148                 4                 2  
           302                 4                 6  
           1853                0                 1  
           265                 1                 7  
           1958                2                 8  
           {\ldots}               {\ldots}               {\ldots}  
           4129                1                10  
           4704                4                 5  
           3589                1                 2  
           1330                4                 7  
           195                 4                 3  
           514                 4                 7  
           2052                4                 5  
           3920                1                 5  
           2374                1                 8  
           1974                1                 8  
           3844                1                 7  
           2799                4                 5  
           406                 4                 6  
           1888                0                 9  
           32                  1                 3  
           1961                4                 4  
           854                 1                 4  
           4271                4                 7  
           4355                1                 8  
           1519                1                 5  
           2527                1                 7  
           4834                4                 9  
           2164                1                 7  
           3647                1                 4  
           1014                1                 6  
           630                 1                 8  
           2701                4                 8  
           4140                1                 7  
           2315                1                 4  
           4172                1                 0  
           
           [1013 rows x 42 columns])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}133}]:} \PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{)}
          
          
          \PY{n}{y\PYZus{}train} \PY{o}{=}  \PY{n}{numpy}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{x\PYZus{}test} \PY{o}{=}  \PY{n}{numpy}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{)}
          \PY{n}{y\PYZus{}test} \PY{o}{=}  \PY{n}{numpy}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}157}]:} \PY{c+c1}{\PYZsh{} This model training code is directly from:}
          \PY{c+c1}{\PYZsh{} https://github.com/keras\PYZhy{}team/keras/blob/master/examples/imdb\PYZus{}lstm.py}
          
          \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}Trains an LSTM model on the IMDB sentiment classification task.}
          \PY{l+s+sd}{The dataset is actually too small for LSTM to be of any advantage}
          \PY{l+s+sd}{compared to simpler, much faster methods such as TF\PYZhy{}IDF + LogReg.}
          \PY{l+s+sd}{\PYZsh{} Notes}
          \PY{l+s+sd}{\PYZhy{} RNNs are tricky. Choice of batch size is important,}
          \PY{l+s+sd}{choice of loss and optimizer is critical, etc.}
          \PY{l+s+sd}{Some configurations won\PYZsq{}t converge.}
          \PY{l+s+sd}{\PYZhy{} LSTM loss decrease patterns during training can be quite different}
          \PY{l+s+sd}{from what you see with CNNs/MLPs/etc.}
          \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
          \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k}{import} \PY{n}{print\PYZus{}function}
          
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{sequence}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
          \PY{c+c1}{\PYZsh{}from keras.layers import Dense, Embedding}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}\PY{p}{,} \PY{n}{Dropout}\PY{p}{,} \PY{n}{Activation}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{LSTM}
          \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k}{import} \PY{n}{imdb}
          
          \PY{n}{max\PYZus{}features} \PY{o}{=} \PY{l+m+mi}{20000}
          \PY{n}{maxlen} \PY{o}{=}\PY{l+m+mi}{41}   \PY{c+c1}{\PYZsh{} cut texts after this number of words (among top max\PYZus{}features most common words)}
          \PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{l+m+mi}{100}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loading data...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}(x\PYZus{}train, y\PYZus{}train), (x\PYZus{}test, y\PYZus{}test) = imdb.load\PYZus{}data(num\PYZus{}words=max\PYZus{}features)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train sequences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test sequences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          
          
          
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pad sequences (samples x time)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{sequence}\PY{o}{.}\PY{n}{pad\PYZus{}sequences}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{maxlen}\PY{o}{=}\PY{n}{maxlen}\PY{p}{)}
          \PY{n}{x\PYZus{}test} \PY{o}{=} \PY{n}{sequence}\PY{o}{.}\PY{n}{pad\PYZus{}sequences}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{maxlen}\PY{o}{=}\PY{n}{maxlen}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x\PYZus{}train shape:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x\PYZus{}test shape:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Build model...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} model = Sequential()}
          \PY{c+c1}{\PYZsh{} model.add(Embedding(max\PYZus{}features, 41))}
          \PY{c+c1}{\PYZsh{} model.add(LSTM(51, dropout=0.2, recurrent\PYZus{}dropout=0.2))}
          \PY{c+c1}{\PYZsh{} model.add(Dense(8, activation=\PYZsq{}softmax\PYZsq{}))}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Build model...  2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          
          \PY{n}{model} \PY{o}{=} \PY{n}{Sequential}\PY{p}{(}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{input\PYZus{}dim}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.25}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{150}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.25}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.25}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} try using different optimizers and different optimizer configs}
          \PY{n}{model}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{categorical\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{optimizer}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{metrics}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,}
                    \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batch\PYZus{}size}\PY{p}{,}
                    \PY{n}{epochs}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}
                    \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n}{score}\PY{p}{,} \PY{n}{acc} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,}
                                      \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batch\PYZus{}size}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test accuracy:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{acc}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Loading data{\ldots}
4052 train sequences
1013 test sequences
Pad sequences (samples x time)
x\_train shape: (4052, 41)
x\_test shape: (1013, 41)
Build model{\ldots}
Build model{\ldots}  2
Train{\ldots}

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        ValueError                                Traceback (most recent call last)

        <ipython-input-157-7066fd6b0da4> in <module>
         70           batch\_size=batch\_size,
         71           epochs=15,
    ---> 72           validation\_data=(x\_test, y\_test))
         73 score, acc = model.evaluate(x\_test, y\_test,
         74                             batch\_size=batch\_size)


        /anaconda3/lib/python3.7/site-packages/keras/engine/training.py in fit(self, x, y, batch\_size, epochs, verbose, callbacks, validation\_split, validation\_data, shuffle, class\_weight, sample\_weight, initial\_epoch, steps\_per\_epoch, validation\_steps, **kwargs)
        950             sample\_weight=sample\_weight,
        951             class\_weight=class\_weight,
    --> 952             batch\_size=batch\_size)
        953         \# Prepare validation data.
        954         do\_validation = False


        /anaconda3/lib/python3.7/site-packages/keras/engine/training.py in \_standardize\_user\_data(self, x, y, sample\_weight, class\_weight, check\_array\_lengths, batch\_size)
        749             feed\_input\_shapes,
        750             check\_batch\_axis=False,  \# Don't enforce the batch size.
    --> 751             exception\_prefix='input')
        752 
        753         if y is not None:


        /anaconda3/lib/python3.7/site-packages/keras/engine/training\_utils.py in standardize\_input\_data(data, names, shapes, check\_batch\_axis, exception\_prefix)
        136                             ': expected ' + names[i] + ' to have shape ' +
        137                             str(shape) + ' but got array with shape ' +
    --> 138                             str(data\_shape))
        139     return data
        140 


        ValueError: Error when checking input: expected dense\_103\_input to have shape (42,) but got array with shape (41,)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}152}]:} \PY{n}{x\PYZus{}train}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}152}]:} (4052, 41)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}146}]:} model.fit\PY{o}{?}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}148}]:} 
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} (5065, 42)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
